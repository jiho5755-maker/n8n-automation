{
  "name": "[F1] í…”ë ˆê·¸ë¨ â†’ ë…¸ì…˜ í•  ì¼ ë“±ë¡",
  "nodes": [
    {
      "parameters": {
        "updates": ["message", "callback_query"],
        "additionalFields": {}
      },
      "id": "node-trigger",
      "name": "TelegramBot",
      "type": "n8n-nodes-base.telegramTrigger",
      "typeVersion": 1.1,
      "position": [0, 300],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ===== ë©”ì‹œì§€ íŒŒì‹± + ì»¤ë§¨ë“œ ë¼ìš°íŒ… =====\n// ì…ë ¥ í˜•ì‹:\n//   í•  ì¼ ë“±ë¡:  '[í”„ë¡œì íŠ¸ - ]í•  ì¼ [@ë‚ ì§œ] [~ëª©í‘œë‚ ì§œ] [#ë©”ëª¨]'\n//   ë‚ ì§œ í‚¤ì›Œë“œ: ì˜¤ëŠ˜, ë‚´ì¼, ëª¨ë ˆ, ë‹¤ìŒì£¼, ì›”~ì¼, M/D\n//   ì‹œê°„ í˜•ì‹:   14:00, 9:30, ì˜¤ì „10ì‹œ, ì˜¤í›„3ì‹œ30ë¶„\n//   ì»¤ë§¨ë“œ:     /ëª©ë¡, /ì™„ë£Œ [ë²ˆí˜¸], /ìƒíƒœ [ë²ˆí˜¸] [ìƒíƒœëª…], /ë°€ë¦°, /ë„ì›€ë§\n\n// callback_query (ì¸ë¼ì¸ ë²„íŠ¼ í´ë¦­) ì²˜ë¦¬\nconst callbackQuery = $input.first().json.callback_query;\nif (callbackQuery) {\n  return [{\n    json: {\n      type: 'callback',\n      callbackData: callbackQuery.data || '',\n      chatId: callbackQuery.message.chat.id,\n      messageId: callbackQuery.message.message_id,\n      callbackQueryId: callbackQuery.id\n    }\n  }];\n}\n\nconst message = $input.first().json.message;\nconst text = (message.text || '').trim();\nconst chatId = message.chat.id;\n\n// --- ë‚ ì§œ íŒŒì‹± í—¬í¼ ---\nfunction addDays(date, days) {\n  const r = new Date(date); r.setDate(r.getDate() + days); return r;\n}\nfunction formatDateLabel(date) {\n  const days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];\n  return `${date.getMonth()+1}/${date.getDate()}(${days[date.getDay()]})`;\n}\nfunction formatDateISO(date) {\n  const y = date.getFullYear();\n  const m = String(date.getMonth()+1).padStart(2,'0');\n  const d = String(date.getDate()).padStart(2,'0');\n  return `${y}-${m}-${d}`;\n}\nfunction parseDateKeyword(keyword) {\n  const now = new Date();\n  // n8n ì„œë²„ê°€ UTCì´ë¯€ë¡œ KST(+9) ê¸°ì¤€ ì˜¤ëŠ˜ ë‚ ì§œ ê³„ì‚°\n  const kst = new Date(now.getTime() + 9*60*60*1000);\n  const today = new Date(kst.getUTCFullYear(), kst.getUTCMonth(), kst.getUTCDate());\n  if (!keyword) return { date: today, label: formatDateLabel(today), iso: formatDateISO(today) };\n  const clean = keyword.replace(/^[@~]/, '').trim();\n  if (clean === 'ì˜¤ëŠ˜') return { date: today, label: formatDateLabel(today), iso: formatDateISO(today) };\n  if (clean === 'ë‚´ì¼') { const d = addDays(today,1); return { date: d, label: formatDateLabel(d), iso: formatDateISO(d) }; }\n  if (clean === 'ëª¨ë ˆ') { const d = addDays(today,2); return { date: d, label: formatDateLabel(d), iso: formatDateISO(d) }; }\n  if (clean === 'ë‹¤ìŒì£¼') { const d = addDays(today,7); return { date: d, label: formatDateLabel(d), iso: formatDateISO(d) }; }\n  const dayMap = {'ì›”':1,'í™”':2,'ìˆ˜':3,'ëª©':4,'ê¸ˆ':5,'í† ':6,'ì¼':0};\n  if (dayMap[clean] !== undefined) {\n    let diff = dayMap[clean] - today.getDay();\n    if (diff <= 0) diff += 7;\n    const d = addDays(today, diff);\n    return { date: d, label: formatDateLabel(d), iso: formatDateISO(d) };\n  }\n  const m = clean.match(/^(\\d{1,2})\\/(\\d{1,2})$/);\n  if (m) {\n    let d = new Date(today.getFullYear(), parseInt(m[1],10)-1, parseInt(m[2],10));\n    if (d < today) d.setFullYear(d.getFullYear()+1);\n    return { date: d, label: formatDateLabel(d), iso: formatDateISO(d) };\n  }\n  return { date: today, label: formatDateLabel(today), iso: formatDateISO(today) };\n}\n\n// --- ì‹œê°„ íŒŒì‹± í—¬í¼ ---\nfunction parseTimeStr(s) {\n  if (!s) return null;\n  const clean = s.trim();\n  // ì˜¤ì „/ì˜¤í›„ í•œêµ­ì–´ í˜•ì‹: ì˜¤ì „10ì‹œ, ì˜¤í›„3ì‹œ30ë¶„\n  const korMatch = clean.match(/^(ì˜¤ì „|ì˜¤í›„)\\s*(\\d{1,2})ì‹œ(?:(\\d{1,2})ë¶„)?$/);\n  if (korMatch) {\n    let hour = parseInt(korMatch[2], 10);\n    const minute = korMatch[3] ? parseInt(korMatch[3], 10) : 0;\n    if (korMatch[1] === 'ì˜¤í›„' && hour < 12) hour += 12;\n    if (korMatch[1] === 'ì˜¤ì „' && hour === 12) hour = 0;\n    const lbl = korMatch[1] + korMatch[2] + 'ì‹œ' + (korMatch[3] ? korMatch[3] + 'ë¶„' : '');\n    return { hour, minute, label: lbl };\n  }\n  // ìˆ«ì:ë¶„ í˜•ì‹: 14:00, 9:30\n  const numMatch = clean.match(/^(\\d{1,2}):(\\d{2})$/);\n  if (numMatch) {\n    const hour = parseInt(numMatch[1], 10);\n    const minute = parseInt(numMatch[2], 10);\n    if (hour >= 0 && hour <= 23 && minute >= 0 && minute <= 59) {\n      const ampm = hour < 12 ? 'ì˜¤ì „' : 'ì˜¤í›„';\n      const h12 = hour % 12 || 12;\n      const lbl = ampm + h12 + 'ì‹œ' + (minute > 0 ? minute + 'ë¶„' : '');\n      return { hour, minute, label: lbl };\n    }\n  }\n  return null;\n}\n\n// --- ì»¤ë§¨ë“œ ì²´í¬ ---\nif (text.startsWith('/')) {\n  const parts = text.trim().split(/\\s+/);\n  const cmd = parts[0].split('@')[0]; // @ë´‡ì´ë¦„ ì œê±°\n  const args = parts.slice(1);\n  return [{ json: { type: 'command', command: cmd, args, chatId, raw: text } }];\n}\n\n// --- ì¼ë°˜ ë©”ì‹œì§€ íŒŒì‹± ---\n// @ë‚ ì§œ [ì‹œê°„], ~ëª©í‘œë‚ ì§œ, #ë©”ëª¨ ì¶”ì¶œ\nconst atMatch = text.match(/@(\\S+)(?:\\s+((?:ì˜¤ì „|ì˜¤í›„)\\s*\\d{1,2}ì‹œ(?:\\d{1,2}ë¶„)?|\\d{1,2}:\\d{2}))?/);\nconst tildeMatch = text.match(/~(\\S+)/);\nconst hashMatch = text.match(/#(.+?)(?=[@~#]|$)/);\n\nconst dateKeyword = atMatch ? atMatch[1] : null;\nconst rawTimeStr = atMatch ? atMatch[2] : null;\nconst dueKeyword = tildeMatch ? tildeMatch[1] : null;\nconst memo = hashMatch ? hashMatch[1].trim() : '';\n\n// íŠ¹ìˆ˜ í† í° ì œê±° í›„ ë³¸ë¬¸ ì¶”ì¶œ\nlet textBody = text\n  .replace(/@\\S+(?:\\s+(?:(?:ì˜¤ì „|ì˜¤í›„)\\s*\\d{1,2}ì‹œ(?:\\d{1,2}ë¶„)?|\\d{1,2}:\\d{2}))?/g, '')\n  .replace(/~\\S+/g, '')\n  .replace(/#.*/g, '')\n  .trim();\n\n// í”„ë¡œì íŠ¸ - í•  ì¼ ë¶„ë¦¬\nlet project = null;\nlet todo = textBody;\nconst sepIdx = textBody.indexOf(' - ');\nif (sepIdx !== -1) {\n  project = textBody.substring(0, sepIdx).trim();\n  todo = textBody.substring(sepIdx + 3).trim();\n}\n\nconst parsed = parseDateKeyword(dateKeyword);\nconst dueParsed = dueKeyword ? parseDateKeyword(dueKeyword) : null;\nconst timeParsed = parseTimeStr(rawTimeStr);\n\n// dateStart: ì‹œê°„ í¬í•¨ ì‹œ datetime ISO(KST), ì•„ë‹ˆë©´ dateë§Œ\nlet dateStart = parsed.iso;\nlet timeLabel = null;\nif (timeParsed) {\n  const hh = String(timeParsed.hour).padStart(2, '0');\n  const mm = String(timeParsed.minute).padStart(2, '0');\n  dateStart = parsed.iso + 'T' + hh + ':' + mm + ':00+09:00';\n  timeLabel = timeParsed.label;\n}\n\nconst dateLabel = parsed.label + (timeLabel ? ' ' + timeLabel : '');\n\nreturn [{\n  json: {\n    type: 'message',\n    project,\n    todo,\n    dateISO: parsed.iso,\n    dateStart,\n    dateLabel,\n    dueISO: dueParsed ? dueParsed.iso : null,\n    dueLabel: dueParsed ? dueParsed.label : null,\n    memo,\n    chatId,\n    raw: text\n  }\n}];"
      },
      "id": "node-parse",
      "name": "ë©”ì‹œì§€ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [220, 300]
    },
    {
      "parameters": {
        "mode": "rules",
        "dataType": "string",
        "value1": "={{ $json.type === 'command' ? $json.command : $json.type }}",
        "rules": {
          "rules": [
            { "operation": "equal", "value2": "message", "output": 0 },
            { "operation": "equal", "value2": "/ëª©ë¡", "output": 1 },
            { "operation": "equal", "value2": "/list", "output": 1 },
            { "operation": "equal", "value2": "/ì™„ë£Œ", "output": 2 },
            { "operation": "equal", "value2": "/ìƒíƒœ", "output": 2 },
            { "operation": "equal", "value2": "/ë„ì›€ë§", "output": 2 },
            { "operation": "equal", "value2": "/help", "output": 2 },
            { "operation": "equal", "value2": "/ë°€ë¦°", "output": 3 },
            { "operation": "equal", "value2": "/í”„ë¡œì íŠ¸", "output": 4 },
            { "operation": "equal", "value2": "callback", "output": 5 },
            { "operation": "equal", "value2": "/ì£¼ê°„", "output": 6 },
            { "operation": "equal", "value2": "/ìˆ˜ì •", "output": 7 }
          ]
        }
      },
      "id": "node-switch",
      "name": "ì»¤ë§¨ë“œ ë¼ìš°í„°",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [440, 300]
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key={{ $env.GEMINI_API_KEY }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Content-Type", "value": "application/json" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const now = new Date(); const kst = new Date(now.getTime() + 9*60*60*1000); const todayISO = kst.toISOString().split('T')[0]; const days=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† ']; const dayName = days[kst.getUTCDay()]; const rawText = $('ë©”ì‹œì§€ íŒŒì‹±').first().json.raw; const prompt = `ì˜¤ëŠ˜ ë‚ ì§œ: ${todayISO}(${dayName}). ì•„ë˜ ë©”ì‹œì§€ì—ì„œ ì—…ë¬´ ì¼ì • ì •ë³´ë¥¼ JSONìœ¼ë¡œ ì¶”ì¶œí•˜ì„¸ìš”. ë°˜ë“œì‹œ JSON í˜•ì‹ë§Œ ë°˜í™˜í•˜ì„¸ìš”.\\n\\në©”ì‹œì§€: \"${rawText.replace(/\"/g, '\\\\\"')}\"\\n\\nì¶œë ¥ JSON ìŠ¤í‚¤ë§ˆ:\\n{\\n  \"title\": \"í•  ì¼ ì œëª© (í•„ìˆ˜)\",\\n  \"projectHint\": \"í”„ë¡œì íŠ¸ëª… íŒíŠ¸ (ì—†ìœ¼ë©´ null)\",\\n  \"date\": \"YYYY-MM-DD (ê¸°ë³¸: ì˜¤ëŠ˜)\",\\n  \"time\": \"HH:mm (ì‹œê°„ ì—†ìœ¼ë©´ null)\",\\n  \"dueDate\": \"YYYY-MM-DD (ëª©í‘œë‚ ì§œ ì—†ìœ¼ë©´ null)\",\\n  \"memo\": \"ë©”ëª¨ ë‚´ìš© (ì—†ìœ¼ë©´ null)\"\\n}\\n\\në‚ ì§œ ê·œì¹™:\\n- ë‚´ì¼: ${new Date(kst.getTime()+86400000).toISOString().split('T')[0]}\\n- ëª¨ë ˆ: ${new Date(kst.getTime()+172800000).toISOString().split('T')[0]}\\n- ë‹¤ìŒì£¼: ${new Date(kst.getTime()+604800000).toISOString().split('T')[0]}\\n- ìš”ì¼(ì›”~ì¼)ì€ ë‹¤ìŒ í•´ë‹¹ ìš”ì¼ ë‚ ì§œë¡œ ê³„ì‚°`; return JSON.stringify({ contents: [{ parts: [{ text: prompt }] }], generationConfig: { responseMimeType: 'application/json' } }); })() }}",
        "options": {
          "timeout": 5000
        }
      },
      "id": "node-gemini-call",
      "name": "Gemini AI íŒŒì‹±",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [660, 60],
      "continueOnFail": true
    },
    {
      "parameters": {
        "jsCode": "// Gemini ì‘ë‹µ íŒŒì‹±\ntry {\n  const response = $input.first().json;\n  \n  // HTTP ì˜¤ë¥˜ ë˜ëŠ” continueOnFailë¡œ ì¸í•œ ì˜¤ë¥˜ ì²´í¬\n  if (response.error || !response.candidates) {\n    return [{ json: { aiSuccess: false, error: 'API ì˜¤ë¥˜', ...($('ë©”ì‹œì§€ íŒŒì‹±').first().json) } }];\n  }\n  \n  const textContent = response.candidates?.[0]?.content?.parts?.[0]?.text;\n  if (!textContent) {\n    return [{ json: { aiSuccess: false, error: 'ì‘ë‹µ ì—†ìŒ', ...($('ë©”ì‹œì§€ íŒŒì‹±').first().json) } }];\n  }\n  \n  const parsed = JSON.parse(textContent);\n  if (!parsed.title) {\n    return [{ json: { aiSuccess: false, error: 'title ì—†ìŒ', ...($('ë©”ì‹œì§€ íŒŒì‹±').first().json) } }];\n  }\n  \n  return [{ json: { aiSuccess: true, aiResult: parsed, ...($('ë©”ì‹œì§€ íŒŒì‹±').first().json) } }];\n} catch(e) {\n  return [{ json: { aiSuccess: false, error: e.message, ...($('ë©”ì‹œì§€ íŒŒì‹±').first().json) } }];\n}"
      },
      "id": "node-gemini-parse",
      "name": "Gemini ì‘ë‹µ íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [880, 60]
    },
    {
      "parameters": {
        "conditions": {
          "options": { "caseSensitive": true, "leftValue": "", "typeValidation": "strict" },
          "conditions": [
            {
              "id": "cond-ai-success",
              "leftValue": "={{ $json.aiSuccess }}",
              "rightValue": true,
              "operator": { "type": "boolean", "operation": "equals" }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "node-ai-success",
      "name": "AI ì„±ê³µ?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [1100, 60]
    },
    {
      "parameters": {
        "jsCode": "// AI íŒŒì‹± ê²°ê³¼ë¥¼ ê¸°ì¡´ í”„ë¡œì íŠ¸ ê²€ìƒ‰ì´ ê¸°ëŒ€í•˜ëŠ” í˜•ì‹ìœ¼ë¡œ ë³€í™˜\nconst base = $json;\nconst ai = base.aiResult;\n\nfunction formatDateLabel(date) {\n  const days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];\n  return `${date.getMonth()+1}/${date.getDate()}(${days[date.getDay()]})`;\n}\n\nconst dateObj = new Date(ai.date + 'T00:00:00+09:00');\nlet dateStart = ai.date;\nlet dateLabel = formatDateLabel(dateObj);\nlet timeLabel = null;\n\nif (ai.time) {\n  const [hh, mm] = ai.time.split(':');\n  dateStart = ai.date + 'T' + hh + ':' + mm + ':00+09:00';\n  const h = parseInt(hh);\n  const ampm = h < 12 ? 'ì˜¤ì „' : 'ì˜¤í›„';\n  const h12 = h % 12 || 12;\n  timeLabel = `${ampm}${h12}ì‹œ${mm !== '00' ? mm+'ë¶„' : ''}`;\n  dateLabel = dateLabel + ' ' + timeLabel;\n}\n\nreturn [{\n  json: {\n    type: 'message',\n    project: ai.projectHint,\n    todo: ai.title,\n    dateISO: ai.date,\n    dateStart,\n    dateLabel,\n    dueISO: ai.dueDate || null,\n    dueLabel: ai.dueDate ? formatDateLabel(new Date(ai.dueDate + 'T00:00:00+09:00')) : null,\n    memo: ai.memo || '',\n    chatId: base.chatId,\n    raw: base.raw,\n    usedAI: true\n  }\n}];"
      },
      "id": "node-ai-to-parsed",
      "name": "AIê²°ê³¼ ë³€í™˜",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1320, -40]
    },
    {
      "parameters": {
        "jsCode": "// AI ì‹¤íŒ¨ ì‹œ ê¸°ì¡´ Regex íŒŒì„œë¡œ í´ë°±\n// ë©”ì‹œì§€ íŒŒì‹± ë…¸ë“œì—ì„œ ì´ë¯¸ íŒŒì‹±ëœ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ í™œìš©\nconst prev = $('ë©”ì‹œì§€ íŒŒì‹±').first().json;\n\n// ì´ë¯¸ node-parseì—ì„œ type:'message'ë¡œ íŒŒì‹±ëœ ê²°ê³¼ê°€ ìˆìœ¼ë¯€ë¡œ\n// ê·¸ëŒ€ë¡œ ì „ë‹¬í•˜ë˜ usedAI: false í”Œë˜ê·¸ë§Œ ì¶”ê°€\nreturn [{\n  json: {\n    type: prev.type,\n    project: prev.project,\n    todo: prev.todo,\n    dateISO: prev.dateISO,\n    dateStart: prev.dateStart,\n    dateLabel: prev.dateLabel,\n    dueISO: prev.dueISO,\n    dueLabel: prev.dueLabel,\n    memo: prev.memo,\n    chatId: prev.chatId,\n    raw: prev.raw,\n    usedAI: false\n  }\n}];"
      },
      "id": "node-ai-fallback",
      "name": "AI í´ë°± íŒŒì„œ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1320, 160]
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-81e2-a747-f9002c0a9910/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ filter: { property: 'í”„ë¡œì íŠ¸', title: { contains: $json.project || '' } }, page_size: 5 }) }}"
      },
      "id": "node-find-project",
      "name": "í”„ë¡œì íŠ¸ ê²€ìƒ‰",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 60]
    },
    {
      "parameters": {
        "jsCode": "// í”„ë¡œì íŠ¸ ë§¤ì¹­ ê²°ê³¼ ì²˜ë¦¬\n// í”„ë¡œì íŠ¸ ê²€ìƒ‰ ë…¸ë“œëŠ” AIê²°ê³¼ ë³€í™˜ ë˜ëŠ” AI í´ë°± íŒŒì„œì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ë¥¼ ë°›ìŒ\n// í”„ë¡œì íŠ¸ ê²€ìƒ‰ì˜ ì…ë ¥ ë°ì´í„°(project, todo ë“±)ëŠ” $('í”„ë¡œì íŠ¸ ê²€ìƒ‰').item.jsonì— í¬í•¨ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ\n// AIê²°ê³¼ ë³€í™˜ ë˜ëŠ” AI í´ë°± íŒŒì„œì—ì„œ ê°€ì ¸ì™€ì•¼ í•¨\nconst results = $input.first().json.results || [];\n\n// ì‹¤í–‰ëœ ì†ŒìŠ¤ ë…¸ë“œì—ì„œ íŒŒì‹± ë°ì´í„° ê°€ì ¸ì˜¤ê¸°\nlet sourceData;\ntry {\n  sourceData = $('AIê²°ê³¼ ë³€í™˜').first().json;\n} catch(e) {\n  try {\n    sourceData = $('AI í´ë°± íŒŒì„œ').first().json;\n  } catch(e2) {\n    // ìµœì¢… í´ë°±: ë©”ì‹œì§€ íŒŒì‹± ë…¸ë“œì˜ ì›ë³¸ ë°ì´í„°\n    sourceData = $('ë©”ì‹œì§€ íŒŒì‹±').first().json;\n  }\n}\n\nlet projectId = null;\nlet projectName = null;\n\nif (sourceData.project && results.length > 0) {\n  projectId = results[0].id;\n  const titleProp = results[0].properties['í”„ë¡œì íŠ¸'];\n  if (titleProp && titleProp.title && titleProp.title.length > 0) {\n    projectName = titleProp.title[0].plain_text;\n  }\n}\n\nreturn [{\n  json: {\n    ...sourceData,\n    projectId,\n    projectName: projectName || sourceData.project,\n    projectMatched: !!projectId\n  }\n}];"
      },
      "id": "node-project-result",
      "name": "í”„ë¡œì íŠ¸ ë§¤ì¹­ ê²°ê³¼",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1760, 60]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-812c-8bf4-fe603e6a8c6b/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ filter: { property: 'ë‚ ì§œ', date: { equals: $json.dateISO } }, page_size: 1 }) }}"
      },
      "id": "node-find-calendar",
      "name": "ìº˜ë¦°ë” ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1980, 60]
    },
    {
      "parameters": {
        "jsCode": "// ìº˜ë¦°ë” ì¡°íšŒ ê²°ê³¼ í™•ì¸\nconst prev = $('í”„ë¡œì íŠ¸ ë§¤ì¹­ ê²°ê³¼').first().json;\nconst results = $input.first().json.results || [];\n\nreturn [{\n  json: {\n    ...prev,\n    calendarId: results.length > 0 ? results[0].id : null,\n    calendarExists: results.length > 0\n  }\n}];"
      },
      "id": "node-calendar-check",
      "name": "ìº˜ë¦°ë” í™•ì¸",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2200, 60]
    },
    {
      "parameters": {
        "conditions": {
          "options": { "caseSensitive": true, "leftValue": "", "typeValidation": "strict" },
          "conditions": [
            {
              "leftValue": "={{ $json.calendarExists }}",
              "rightValue": true,
              "operator": { "type": "boolean", "operation": "equals" }
            }
          ]
        }
      },
      "id": "node-if-calendar",
      "name": "ìº˜ë¦°ë” ì¡´ì¬?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [2420, 60]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.notion.com/v1/pages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ parent: { database_id: '30bd119f-a669-812c-8bf4-fe603e6a8c6b' }, properties: { 'ìº˜ë¦°ë”': { title: [{ text: { content: $json.dateLabel } }] }, 'ë‚ ì§œ': { date: { start: $json.dateISO } } } }) }}"
      },
      "id": "node-create-calendar",
      "name": "ìº˜ë¦°ë” ìƒì„±",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [2640, 200]
    },
    {
      "parameters": {
        "jsCode": "// ìº˜ë¦°ë” ID í†µí•© (ê¸°ì¡´ ë˜ëŠ” ìƒˆë¡œ ìƒì„±ëœ ê²ƒ)\nconst prev = $('ìº˜ë¦°ë” í™•ì¸').first().json;\nlet calendarId = prev.calendarId;\n\ntry {\n  const created = $('ìº˜ë¦°ë” ìƒì„±').first().json;\n  if (created && created.id) calendarId = created.id;\n} catch(e) {}\n\nreturn [{\n  json: {\n    ...prev,\n    calendarId\n  }\n}];"
      },
      "id": "node-merge-calendar",
      "name": "ìº˜ë¦°ë” ID í†µí•©",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [2860, 60]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.notion.com/v1/pages",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const d = $json; const props = { 'í•  ì¼': { title: [{ text: { content: d.todo } }] }, 'ìƒíƒœ': { status: { name: 'ì‹œì‘ ì „' } }, 'ì‹œê°„ ': { date: { start: d.dateStart } } }; if (d.dueISO) { props['ëª©í‘œë‚ ì§œ'] = { date: { start: d.dueISO } }; } if (d.memo) { props['ë©”ëª¨'] = { rich_text: [{ text: { content: d.memo } }] }; } if (d.projectId) { props['í”„ë¡œì íŠ¸'] = { relation: [{ id: d.projectId }] }; } if (d.calendarId) { props['ìº˜ë¦°ë”'] = { relation: [{ id: d.calendarId }] }; } return JSON.stringify({ parent: { database_id: '30bd119f-a669-81d0-8730-d824b7bc948c' }, properties: props }); })() }}"
      },
      "id": "node-create-todo",
      "name": "í•  ì¼ ìƒì„±",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [3080, 60]
    },
    {
      "parameters": {
        "jsCode": "// í™•ì¸ ë©”ì‹œì§€ í¬ë§·íŒ…\nconst prev = $('ìº˜ë¦°ë” ID í†µí•©').first().json;\nconst notionPage = $input.first().json;\nconst pageId = notionPage.id || '';\n\nlet msg = '\\u2705 í•  ì¼ ë“±ë¡ ì™„ë£Œ\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501';\nmsg += `\\n\\ud83d\\udccb ${prev.todo}`;\nif (prev.projectMatched) {\n  msg += `\\n\\ud83d\\udcc1 ${prev.projectName}`;\n} else if (prev.project) {\n  msg += `\\n\\ud83d\\udcc1 ${prev.project} \\u26a0\\ufe0f \\ubbf8\\ub9e4\\uce6d`;\n} else {\n  msg += `\\n\\ud83d\\udcc1 \\ubbf8\\uc9c0\\uc815 (\\uce98\\ub9b0\\ub354 \\ubdf0 \\ubbf8\\ud45c\\uc2dc)`;\n  msg += `\\n\\ud83d\\udca1 \\uce98\\ub9b0\\ub354\\uc5d0 \\ud45c\\uc2dc\\ud558\\ub824\\uba74: \\ud504\\ub85c\\uc81d\\ud2b8 - \\ud560 \\uc77c \\ud615\\uc2dd`;\n  msg += `\\n   \\uc608) \\uc6b4\\ub3d9 - \\ub18d\\uad6c @\\uc624\\ub298`;\n}\nif (prev.usedAI === false) msg += '\\n\\u26a0\\ufe0f \\uae30\\ubcf8 \\ud30c\\uc11c \\uc0ac\\uc6a9';\nmsg += `\\n\\ud83d\\udcc5 ${prev.dateLabel}`;\nif (prev.dueLabel) {\n  msg += `\\n\\ud83c\\udfaf \\ubaa9\\ud45c: ${prev.dueLabel}`;\n}\nif (prev.memo) {\n  msg += `\\n\\ud83d\\udcdd \\uba54\\ubaa8: ${prev.memo}`;\n}\n\nreturn [{ json: { chatId: prev.chatId, text: msg, pageId } }];"
      },
      "id": "node-format-reply",
      "name": "í™•ì¸ ë©”ì‹œì§€ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [3300, 60]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $env.TELEGRAM_BOT_TOKEN }}/sendMessage",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const d = $json; const body = { chat_id: d.chatId, text: d.text }; if (d.pageId) { body.reply_markup = { inline_keyboard: [[{ text: '\\u2705 ì™„ë£Œ', callback_data: 'done:' + d.pageId }, { text: '\\ud83d\\udd35 ì§„í–‰ì¤‘', callback_data: 'inprogress:' + d.pageId }, { text: '\\ud83d\\udccc í•€', callback_data: 'pin:' + d.pageId }]] }; } return JSON.stringify(body); })() }}"
      },
      "id": "node-reply",
      "name": "í™•ì¸ íšŒì‹ ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [3520, 60]
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-81d0-8730-d824b7bc948c/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const now = new Date(); const kst = new Date(now.getTime() + 9*60*60*1000); const y = kst.getUTCFullYear(); const m = String(kst.getUTCMonth()+1).padStart(2,'0'); const d = String(kst.getUTCDate()).padStart(2,'0'); const today = y+'-'+m+'-'+d; return JSON.stringify({ filter: { and: [{ property: 'ì‹œê°„ ', date: { equals: today } }, { property: 'ìƒíƒœ', status: { does_not_equal: 'ì™„ë£Œ' } }, { property: 'ìƒíƒœ', status: { does_not_equal: 'ì·¨ì†Œ' } }] }, sorts: [{ property: 'ì‹œê°„ ', direction: 'ascending' }], page_size: 50 }); })() }}"
      },
      "id": "node-list-today",
      "name": "ì˜¤ëŠ˜ í•  ì¼ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [660, 360]
    },
    {
      "parameters": {
        "jsCode": "// /ëª©ë¡ ê²°ê³¼ í¬ë§·íŒ…\nconst chatId = $('ë©”ì‹œì§€ íŒŒì‹±').first().json.chatId;\nconst results = $input.first().json.results || [];\n\n// static dataì— ì €ì¥ (for /ìˆ˜ì • ì»¤ë§¨ë“œ)\nconst staticData = $getWorkflowStaticData('global');\nstaticData.lastList = results.map((item, i) => ({\n  index: i + 1,\n  pageId: item.id,\n  title: item.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)'\n}));\n\nconst now = new Date();\nconst kst = new Date(now.getTime() + 9*60*60*1000);\nconst days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];\nconst dateLabel = `${kst.getUTCMonth()+1}/${kst.getUTCDate()}(${days[kst.getUTCDay()]})`;\n\nif (results.length === 0) {\n  return [{ json: { chatId, text: `ğŸ“‹ ${dateLabel} í•  ì¼\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n\\në“±ë¡ëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.\\n\\ní•  ì¼ ë“±ë¡: ìš´ë™ @ì˜¤ëŠ˜` } }];\n}\n\nconst statusIcon = { 'ì§„í–‰ ì¤‘': 'ğŸ”µ', 'ê±°ì˜ ì™„ë£Œ': 'ğŸŸ¡', 'í•€': 'ğŸ“Œ', 'ì™„ë£Œ': 'âœ…', 'ì·¨ì†Œ': 'âŒ', 'ëª»í•¨': 'ğŸ’¤' };\n\nlet msg = `ğŸ“‹ ${dateLabel} í•  ì¼\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n`;\n\nresults.forEach((item, i) => {\n  const title = item.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)';\n  const status = item.properties['ìƒíƒœ']?.status?.name || 'ì‹œì‘ ì „';\n  const icon = statusIcon[status] || 'â¬œ';\n  msg += `\\n${icon} ${i+1}. ${title}`;\n  if (status !== 'ì‹œì‘ ì „') msg += ` [${status}]`;\n});\n\nmsg += `\\n\\nğŸ“Š ì´ ${results.length}ê±´`;\nmsg += `\\n\\nğŸ’¡ /ì™„ë£Œ [ë²ˆí˜¸]  /ìƒíƒœ [ë²ˆí˜¸] [ìƒíƒœëª…]`;\n\nreturn [{ json: { chatId, text: msg } }];"
      },
      "id": "node-format-list",
      "name": "ëª©ë¡ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [880, 360]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "node-reply-list",
      "name": "ëª©ë¡ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1100, 360],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },

    {
      "parameters": {
        "jsCode": "// /ì™„ë£Œ, /ìƒíƒœ, /ë„ì›€ë§ 2ì°¨ ë¶„ê¸°\nconst data = $('ë©”ì‹œì§€ íŒŒì‹±').first().json;\nconst cmd = data.command;\nconst args = data.args || [];\nconst chatId = data.chatId;\n\nif (cmd === '/ë„ì›€ë§' || cmd === '/help') {\n  return [{ json: { route: 'help', chatId } }];\n}\n\nif (cmd === '/ì™„ë£Œ') {\n  const num = parseInt(args[0]);\n  if (!num || num < 1) {\n    return [{ json: { route: 'error', chatId, errorMsg: 'ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.\\nì˜ˆ) /ì™„ë£Œ 1' } }];\n  }\n  return [{ json: { route: 'complete', chatId, num, newStatus: 'ì™„ë£Œ' } }];\n}\n\nif (cmd === '/ìƒíƒœ') {\n  const num = parseInt(args[0]);\n  const statusInput = args.slice(1).join(' ').trim();\n  const statusMap = {\n    'ì‹œì‘': 'ì‹œì‘ ì „', 'ì‹œì‘ì „': 'ì‹œì‘ ì „',\n    'ì§„í–‰': 'ì§„í–‰ ì¤‘', 'ì§„í–‰ì¤‘': 'ì§„í–‰ ì¤‘',\n    'ì™„ë£Œ': 'ì™„ë£Œ',\n    'ê±°ì˜': 'ê±°ì˜ ì™„ë£Œ', 'ê±°ì˜ì™„ë£Œ': 'ê±°ì˜ ì™„ë£Œ',\n    'ì·¨ì†Œ': 'ì·¨ì†Œ', 'í•€': 'í•€', 'ëª»í•¨': 'ëª»í•¨'\n  };\n  const newStatus = statusMap[statusInput] || statusInput;\n  const validStatuses = ['ì‹œì‘ ì „', 'ì§„í–‰ ì¤‘', 'ì™„ë£Œ', 'ê±°ì˜ ì™„ë£Œ', 'ì·¨ì†Œ', 'í•€', 'ëª»í•¨', 'Good', 'Try', 'Problem', 'ì´í›„ ì™„ë£Œ'];\n\n  if (!num || num < 1 || !statusInput) {\n    return [{ json: { route: 'error', chatId, errorMsg: 'í˜•ì‹: /ìƒíƒœ [ë²ˆí˜¸] [ìƒíƒœëª…]\\nì˜ˆ) /ìƒíƒœ 1 ì§„í–‰ì¤‘\\n\\nìƒíƒœ ëª©ë¡: ì‹œì‘ì „ ì§„í–‰ì¤‘ ì™„ë£Œ ê±°ì˜ì™„ë£Œ ì·¨ì†Œ í•€ ëª»í•¨' } }];\n  }\n  if (!validStatuses.includes(newStatus)) {\n    return [{ json: { route: 'error', chatId, errorMsg: `'${statusInput}'ì€ ì˜¬ë°”ë¥¸ ìƒíƒœê°€ ì•„ë‹™ë‹ˆë‹¤.\\n\\nì‚¬ìš© ê°€ëŠ¥: ì‹œì‘ì „ ì§„í–‰ì¤‘ ì™„ë£Œ ê±°ì˜ì™„ë£Œ ì·¨ì†Œ í•€ ëª»í•¨` } }];\n  }\n  return [{ json: { route: 'status', chatId, num, newStatus } }];\n}\n\nreturn [{ json: { route: 'error', chatId, errorMsg: 'ì•Œ ìˆ˜ ì—†ëŠ” ëª…ë ¹ì…ë‹ˆë‹¤. /ë„ì›€ë§ ì„ ì…ë ¥í•´ë³´ì„¸ìš”.' } }];"
      },
      "id": "node-action-router",
      "name": "ì•¡ì…˜ ë¶„ê¸°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 560]
    },
    {
      "parameters": {
        "mode": "rules",
        "dataType": "string",
        "value1": "={{ $json.route }}",
        "rules": {
          "rules": [
            { "operation": "equal", "value2": "complete", "output": 0 },
            { "operation": "equal", "value2": "status", "output": 1 },
            { "operation": "equal", "value2": "help", "output": 2 },
            { "operation": "equal", "value2": "error", "output": 3 }
          ]
        }
      },
      "id": "node-action-switch",
      "name": "ì•¡ì…˜ ìŠ¤ìœ„ì¹˜",
      "type": "n8n-nodes-base.switch",
      "typeVersion": 1,
      "position": [880, 560]
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-81d0-8730-d824b7bc948c/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const now = new Date(); const kst = new Date(now.getTime() + 9*60*60*1000); const y = kst.getUTCFullYear(); const m = String(kst.getUTCMonth()+1).padStart(2,'0'); const d = String(kst.getUTCDate()).padStart(2,'0'); const today = y+'-'+m+'-'+d; return JSON.stringify({ filter: { property: 'ì‹œê°„ ', date: { equals: today } }, sorts: [{ property: 'ì‹œê°„ ', direction: 'ascending' }], page_size: 50 }); })() }}"
      },
      "id": "node-complete-list",
      "name": "ì™„ë£Œ/ìƒíƒœë³€ê²½ ëª©ë¡ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1100, 480]
    },
    {
      "parameters": {
        "jsCode": "// ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” í˜ì´ì§€ ì°¾ì•„ì„œ ìƒíƒœ ë³€ê²½\nconst ctx = $('ì•¡ì…˜ ë¶„ê¸°').first().json;\nconst results = $input.first().json.results || [];\n\nif (ctx.num > results.length) {\n  return [{ json: { chatId: ctx.chatId, errorMsg: `ì˜¤ëŠ˜ í•  ì¼ì´ ${results.length}ê±´ì´ì—ìš”. ${results.length}ë²ˆ ì´í•˜ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.`, route: 'error' } }];\n}\n\nconst target = results[ctx.num - 1];\nconst title = target.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)';\n\nreturn [{ json: { chatId: ctx.chatId, pageId: target.id, title, num: ctx.num, newStatus: ctx.newStatus, route: 'update' } }];"
      },
      "id": "node-find-target",
      "name": "ëŒ€ìƒ í˜ì´ì§€ í™•ì¸",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1320, 480]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/pages/{{ $json.pageId }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ properties: { 'ìƒíƒœ': { status: { name: $json.newStatus } } } }) }}"
      },
      "id": "node-patch-status",
      "name": "ë…¸ì…˜ ìƒíƒœ ë³€ê²½",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1540, 480]
    },
    {
      "parameters": {
        "jsCode": "const target = $('ëŒ€ìƒ í˜ì´ì§€ í™•ì¸').first().json;\nconst statusIcon = { 'ì™„ë£Œ': 'âœ…', 'ì§„í–‰ ì¤‘': 'ğŸ”µ', 'ì·¨ì†Œ': 'âŒ', 'ê±°ì˜ ì™„ë£Œ': 'ğŸŸ¡', 'í•€': 'ğŸ“Œ', 'ì‹œì‘ ì „': 'â¬œ', 'ëª»í•¨': 'ğŸ’¤' };\nconst icon = statusIcon[target.newStatus] || 'ğŸ”„';\nconst msg = `${icon} ${target.newStatus} ì²˜ë¦¬\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\nğŸ“‹ ${target.title}`;\nreturn [{ json: { chatId: target.chatId, text: msg } }];"
      },
      "id": "node-format-action-result",
      "name": "ì²˜ë¦¬ê²°ê³¼ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1760, 480]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "node-reply-action",
      "name": "ì²˜ë¦¬ê²°ê³¼ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1980, 480],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },

    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-81d0-8730-d824b7bc948c/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const now = new Date(); const kst = new Date(now.getTime() + 9*60*60*1000); const y = kst.getUTCFullYear(); const m = String(kst.getUTCMonth()+1).padStart(2,'0'); const d = String(kst.getUTCDate()).padStart(2,'0'); const today = y+'-'+m+'-'+d; return JSON.stringify({ filter: { and: [{ property: 'ëª©í‘œë‚ ì§œ', date: { before: today } }, { property: 'ìƒíƒœ', status: { does_not_equal: 'ì™„ë£Œ' } }, { property: 'ìƒíƒœ', status: { does_not_equal: 'ì·¨ì†Œ' } }] }, sorts: [{ property: 'ëª©í‘œë‚ ì§œ', direction: 'ascending' }] }); })() }}"
      },
      "id": "node-list-overdue",
      "name": "ë°€ë¦° ì—…ë¬´ ì¡°íšŒ (ì»¤ë§¨ë“œ)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [660, 800]
    },
    {
      "parameters": {
        "jsCode": "// /ë°€ë¦° ê²°ê³¼ í¬ë§·íŒ…\nconst chatId = $('ë©”ì‹œì§€ íŒŒì‹±').first().json.chatId;\nconst results = $input.first().json.results || [];\n\nif (results.length === 0) {\n  return [{ json: { chatId, text: 'âœ… ë°€ë¦° ì—…ë¬´ê°€ ì—†ìŠµë‹ˆë‹¤!' } }];\n}\n\nconst now = new Date();\nconst kst = new Date(now.getTime() + 9*60*60*1000);\nconst today = new Date(kst.getUTCFullYear(), kst.getUTCMonth(), kst.getUTCDate());\n\nconst severe = []; const mild = [];\n\nresults.forEach(item => {\n  const title = item.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)';\n  const dueDate = item.properties['ëª©í‘œë‚ ì§œ']?.date?.start;\n  if (!dueDate) return;\n  const due = new Date(dueDate);\n  const diffDays = Math.floor((today - due) / (1000*60*60*24));\n  const entry = { title, diffDays };\n  if (diffDays >= 3) severe.push(entry);\n  else mild.push(entry);\n});\n\nlet msg = 'âš ï¸ ë°€ë¦° ì—…ë¬´ ì•Œë¦¼\\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\\n';\nif (severe.length > 0) {\n  msg += '\\nğŸ”´ 3ì¼+ ê²½ê³¼';\n  severe.forEach(e => { msg += `\\n  Â· ${e.title} (${e.diffDays}ì¼)`; });\n}\nif (mild.length > 0) {\n  msg += '\\n\\nğŸŸ¡ 1~2ì¼ ê²½ê³¼';\n  mild.forEach(e => { msg += `\\n  Â· ${e.title} (${e.diffDays}ì¼)`; });\n}\nmsg += '\\n\\nğŸ’¡ /ì™„ë£Œ [ë²ˆí˜¸] ë¡œ ì²˜ë¦¬í•˜ì„¸ìš”';\n\nreturn [{ json: { chatId, text: msg } }];"
      },
      "id": "node-format-overdue",
      "name": "ë°€ë¦° ì—…ë¬´ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [880, 800]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "node-reply-overdue",
      "name": "ë°€ë¦° ì—…ë¬´ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1100, 800],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },

    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "=ğŸ“– ì‚¬ìš©ë²• ì•ˆë‚´\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ“‹ í•  ì¼ ë“±ë¡\n  [í”„ë¡œì íŠ¸ - ]í•  ì¼ [@ë‚ ì§œ [ì‹œê°„]] [~ëª©í‘œë‚ ì§œ] [#ë©”ëª¨]\n\n  ì˜ˆì‹œ:\n  Â· ìš´ë™ @ì˜¤ëŠ˜\n  Â· íŒ€ ë¯¸íŒ… @ì˜¤ëŠ˜ 14:00\n  Â· ìœ íŠœë¸Œ - ì˜ìƒí¸ì§‘ @ë‚´ì¼ ì˜¤ì „9ì‹œ ~ë‹¤ìŒì£¼\n  Â· í™ˆí˜ì´ì§€ - ë°°ë„ˆìˆ˜ì • @ì›”\n\n  ğŸ¤– AI ìì—°ì–´ë„ ì§€ì›!\n  Â· ë‚´ì¼ ì˜¤í›„ 3ì‹œì— íŒ€ ë¯¸íŒ…\n  Â· ë‹¤ìŒì£¼ ê¸ˆìš”ì¼ê¹Œì§€ ë³´ê³ ì„œ ì‘ì„±\n\nğŸ“… ë‚ ì§œ í‚¤ì›Œë“œ\n  ì˜¤ëŠ˜ ë‚´ì¼ ëª¨ë ˆ ë‹¤ìŒì£¼\n  ì›”í™”ìˆ˜ëª©ê¸ˆí† ì¼, M/D\n\nâ° ì‹œê°„ í˜•ì‹\n  14:00  9:30  ì˜¤ì „10ì‹œ  ì˜¤í›„3ì‹œ30ë¶„\n\nğŸ”§ ì»¤ë§¨ë“œ\n  /ëª©ë¡        ì˜¤ëŠ˜ í•  ì¼ ë³´ê¸°\n  /ì™„ë£Œ 1      1ë²ˆ í•­ëª© ì™„ë£Œ\n  /ìƒíƒœ 1 ì§„í–‰ì¤‘  ìƒíƒœ ë³€ê²½\n  /ë°€ë¦°        ê¸°í•œ ì§€ë‚œ ì—…ë¬´\n  /í”„ë¡œì íŠ¸    í”„ë¡œì íŠ¸ ëª©ë¡ ë³´ê¸°\n  /ë„ì›€ë§      ì´ ë©”ì‹œì§€",
        "additionalFields": {}
      },
      "id": "node-reply-help",
      "name": "ë„ì›€ë§ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1100, 640],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.errorMsg }}",
        "additionalFields": {}
      },
      "id": "node-reply-error",
      "name": "ì˜¤ë¥˜ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1100, 720],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// callback_query: callback_data íŒŒì‹± (í˜•ì‹: statusCode:pageId)\nconst data = $json;\nconst callbackData = data.callbackData || '';\nconst colonIdx = callbackData.indexOf(':');\nconst statusCode = colonIdx !== -1 ? callbackData.substring(0, colonIdx) : '';\nconst pageId = colonIdx !== -1 ? callbackData.substring(colonIdx + 1) : '';\n\nconst statusMap = { 'done': 'ì™„ë£Œ', 'inprogress': 'ì§„í–‰ ì¤‘', 'pin': 'í•€' };\nconst statusName = statusMap[statusCode];\n\nif (!statusName || !pageId) {\n  return [{ json: { ...data, valid: false } }];\n}\n\nreturn [{ json: { ...data, statusCode, statusName, pageId, valid: true } }];"
      },
      "id": "node-callback-parse",
      "name": "Callback ì²˜ë¦¬",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 1200]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $env.TELEGRAM_BOT_TOKEN }}/answerCallbackQuery",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ callback_query_id: $json.callbackQueryId, text: $json.statusName + ' ì²˜ë¦¬ ì¤‘...' }) }}"
      },
      "id": "node-callback-answer",
      "name": "CallbackQuery ì‘ë‹µ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 1200],
      "continueOnFail": true
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/pages/{{ $('Callback ì²˜ë¦¬').first().json.pageId }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ properties: { 'ìƒíƒœ': { status: { name: $('Callback ì²˜ë¦¬').first().json.statusName } } } }) }}"
      },
      "id": "node-callback-notion",
      "name": "Notion ìƒíƒœ ë³€ê²½ (Callback)",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1100, 1200],
      "continueOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.telegram.org/bot{{ $env.TELEGRAM_BOT_TOKEN }}/editMessageText",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ (() => { const d = $('Callback ì²˜ë¦¬').first().json; const statusIcon = {'ì™„ë£Œ':'\\u2705','ì§„í–‰ ì¤‘':'\\ud83d\\udd35','í•€':'\\ud83d\\udccc'}; const icon = statusIcon[d.statusName] || '\\ud83d\\udd04'; return JSON.stringify({ chat_id: d.chatId, message_id: d.messageId, text: icon + ' ' + d.statusName + ' ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.', reply_markup: { inline_keyboard: [] } }); })() }}"
      },
      "id": "node-callback-edit",
      "name": "ë©”ì‹œì§€ ë²„íŠ¼ ì œê±°",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1320, 1200]
    },

    {
      "parameters": {
        "jsCode": "// ì´ë²ˆ ì£¼ ì›”~ì¼ ë‚ ì§œ ë²”ìœ„ ê³„ì‚° (KST ê¸°ì¤€)\nconst now = new Date();\nconst kst = new Date(now.getTime() + 9*60*60*1000);\nconst chatId = $('ë©”ì‹œì§€ íŒŒì‹±').first().json.chatId;\n\nconst day = kst.getUTCDay(); // 0=ì¼, 1=ì›”\nconst daysFromMon = day === 0 ? 6 : day - 1;\n\nconst monday = new Date(kst);\nmonday.setUTCDate(monday.getUTCDate() - daysFromMon);\nmonday.setUTCHours(0, 0, 0, 0);\n\nconst sunday = new Date(monday);\nsunday.setUTCDate(monday.getUTCDate() + 6);\n\nconst monISO = monday.toISOString().split('T')[0];\nconst sunISO = sunday.toISOString().split('T')[0];\n\nreturn [{ json: { monISO, sunISO, chatId } }];"
      },
      "id": "node-weekly-calc",
      "name": "ì´ë²ˆ ì£¼ ë‚ ì§œ ê³„ì‚°",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 1400]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://api.notion.com/v1/databases/30bd119f-a669-81d0-8730-d824b7bc948c/query",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify({ filter: { and: [{ property: 'ì‹œê°„ ', date: { on_or_after: $json.monISO } }, { property: 'ì‹œê°„ ', date: { on_or_before: $json.sunISO } }] }, sorts: [{ property: 'ì‹œê°„ ', direction: 'ascending' }], page_size: 100 }) }}"
      },
      "id": "node-weekly-query",
      "name": "ì´ë²ˆ ì£¼ í•  ì¼ ì¡°íšŒ",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [880, 1400]
    },
    {
      "parameters": {
        "jsCode": "// ì£¼ê°„ í¬ë§· + static data ì €ì¥ (for /ìˆ˜ì • ì»¤ë§¨ë“œ)\nconst ctx = $('ì´ë²ˆ ì£¼ ë‚ ì§œ ê³„ì‚°').first().json;\nconst chatId = ctx.chatId;\nconst results = $input.first().json.results || [];\n\n// static data ì €ì¥ (ë²ˆí˜¸â†’pageId ë§¤í•‘)\nconst staticData = $getWorkflowStaticData('global');\nstaticData.lastList = results.map((item, i) => ({\n  index: i + 1,\n  pageId: item.id,\n  title: item.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)'\n}));\n\nconst total = results.length;\nconst doneCount = results.filter(r => r.properties['ìƒíƒœ']?.status?.name === 'ì™„ë£Œ').length;\nconst rate = total > 0 ? Math.round(doneCount / total * 100) : 0;\n\nconst statusIcon = {'ì§„í–‰ ì¤‘':'\\ud83d\\udd35','ê±°ì˜ ì™„ë£Œ':'\\ud83d\\udfe1','í•€':'\\ud83d\\udccc','ì™„ë£Œ':'\\u2705','ì·¨ì†Œ':'\\u274c','ëª»í•¨':'\\ud83d\\udca4','ì‹œì‘ ì „':'\\u2b1c'};\nconst days = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];\n\nif (results.length === 0) {\n  return [{ json: { chatId, text: `\\ud83d\\udcc5 ì´ë²ˆ ì£¼ (${ctx.monISO.substring(5)} ~ ${ctx.sunISO.substring(5)})\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n\\në“±ë¡ëœ í•  ì¼ì´ ì—†ìŠµë‹ˆë‹¤.` } }];\n}\n\nconst grouped = {};\nresults.forEach((item, i) => {\n  const dateRaw = item.properties['ì‹œê°„ ']?.date?.start || 'ë‚ ì§œì—†ìŒ';\n  const date = dateRaw.split('T')[0];\n  if (!grouped[date]) grouped[date] = [];\n  grouped[date].push({ item, index: i + 1 });\n});\n\nlet msg = `\\ud83d\\udcc5 ì´ë²ˆ ì£¼ í•  ì¼ (${ctx.monISO.substring(5)} ~ ${ctx.sunISO.substring(5)})\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n`;\n\nfor (const [date, items] of Object.entries(grouped).sort()) {\n  const dateObj = new Date(date + 'T00:00:00+09:00');\n  const m = dateObj.getMonth() + 1;\n  const d = dateObj.getDate();\n  msg += `\\n${m}/${d}(${days[dateObj.getDay()]})\\n`;\n  items.forEach(({ item, index }) => {\n    const title = item.properties['í•  ì¼']?.title?.[0]?.plain_text || '(ì œëª© ì—†ìŒ)';\n    const status = item.properties['ìƒíƒœ']?.status?.name || 'ì‹œì‘ ì „';\n    const icon = statusIcon[status] || '\\u2b1c';\n    msg += `${icon} ${index}. ${title}\\n`;\n  });\n}\n\nmsg += `\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n\\ud83d\\udcca ${total}ê±´ | \\u2705 ì™„ë£Œìœ¨ ${rate}% (${doneCount}/${total})\\n\\ud83d\\udca1 /ìˆ˜ì • [ë²ˆí˜¸] [ë‚´ìš©] ë˜ëŠ” /ìˆ˜ì • [ë²ˆí˜¸] @ë‚ ì§œ`;\n\nreturn [{ json: { chatId, text: msg } }];"
      },
      "id": "node-weekly-format",
      "name": "ì£¼ê°„ í¬ë§·",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [1100, 1400]
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.text }}",
        "additionalFields": {}
      },
      "id": "node-weekly-reply",
      "name": "ì£¼ê°„ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1320, 1400],
      "credentials": {
        "telegramApi": { "id": "1", "name": "Telegram Bot" }
      }
    },

    {
      "parameters": {
        "jsCode": "// /ìˆ˜ì • ì»¤ë§¨ë“œ íŒŒì‹±\nconst data = $('ë©”ì‹œì§€ íŒŒì‹±').first().json;\nconst args = data.args || [];\nconst chatId = data.chatId;\n\nconst num = parseInt(args[0]);\nconst content = args.slice(1).join(' ').trim();\n\nif (!num || num < 1 || !content) {\n  return [{ json: { chatId, valid: false, errorMsg: 'í˜•ì‹: /ìˆ˜ì • [ë²ˆí˜¸] [ìƒˆ ì œëª©] ë˜ëŠ” @ë‚ ì§œ\\nì˜ˆ) /ìˆ˜ì • 1 ìƒˆë¡œìš´ ì œëª©\\n    /ìˆ˜ì • 2 @ë‚´ì¼' } }];\n}\n\nconst staticData = $getWorkflowStaticData('global');\nconst lastList = staticData.lastList || [];\n\nif (lastList.length === 0) {\n  return [{ json: { chatId, valid: false, errorMsg: '/ëª©ë¡ ë˜ëŠ” /ì£¼ê°„ ë¨¼ì € ì‹¤í–‰í•˜ì„¸ìš”.' } }];\n}\n\nconst target = lastList.find(item => item.index === num);\nif (!target) {\n  return [{ json: { chatId, valid: false, errorMsg: `${num}ë²ˆ í•­ëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n/ëª©ë¡ ë˜ëŠ” /ì£¼ê°„ í›„ ë²ˆí˜¸ë¥¼ í™•ì¸í•˜ì„¸ìš”.` } }];\n}\n\nconst isDateChange = content.startsWith('@');\n\nif (isDateChange) {\n  const keyword = content.replace(/^@/, '').trim();\n  function parseDateKeyword(kw) {\n    const now = new Date();\n    const kst = new Date(now.getTime() + 9*60*60*1000);\n    const today = new Date(kst.getUTCFullYear(), kst.getUTCMonth(), kst.getUTCDate());\n    function addDays(d, n) { const r = new Date(d); r.setDate(r.getDate() + n); return r; }\n    function toISO(d) { return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0'); }\n    if (kw === 'ì˜¤ëŠ˜') return toISO(today);\n    if (kw === 'ë‚´ì¼') return toISO(addDays(today, 1));\n    if (kw === 'ëª¨ë ˆ') return toISO(addDays(today, 2));\n    if (kw === 'ë‹¤ìŒì£¼') return toISO(addDays(today, 7));\n    const dayMap = {'ì›”':1,'í™”':2,'ìˆ˜':3,'ëª©':4,'ê¸ˆ':5,'í† ':6,'ì¼':0};\n    if (dayMap[kw] !== undefined) { let diff = dayMap[kw] - today.getDay(); if (diff <= 0) diff += 7; return toISO(addDays(today, diff)); }\n    const m = kw.match(/^(\\d{1,2})\\/(\\d{1,2})$/);\n    if (m) { let d = new Date(today.getFullYear(), parseInt(m[1])-1, parseInt(m[2])); if (d < today) d.setFullYear(d.getFullYear()+1); return toISO(d); }\n    return toISO(today);\n  }\n  const newDate = parseDateKeyword(keyword);\n  const patchBody = { properties: { 'ì‹œê°„ ': { date: { start: newDate } } } };\n  return [{ json: { chatId, valid: true, pageId: target.pageId, title: target.title, patchBody, successMsg: `\\ud83d\\uddd3 ë‚ ì§œ ë³€ê²½\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n\\ud83d\\udccb ${target.title}\\n\\ud83d\\udcc5 ${newDate}` } }];\n}\n\nconst patchBody = { properties: { 'í•  ì¼': { title: [{ text: { content } }] } } };\nreturn [{ json: { chatId, valid: true, pageId: target.pageId, title: target.title, patchBody, successMsg: `\\u270f\\ufe0f ì œëª© ë³€ê²½\\n\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\u2501\\n\\u2192 ${content}` } }];"
      },
      "id": "node-edit-parse",
      "name": "ìˆ˜ì • íŒŒì‹±",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [660, 1600]
    },
    {
      "parameters": {
        "conditions": {
          "options": { "caseSensitive": true, "leftValue": "", "typeValidation": "strict" },
          "conditions": [
            {
              "id": "cond-edit-valid",
              "leftValue": "={{ $json.valid }}",
              "rightValue": true,
              "operator": { "type": "boolean", "operation": "equals" }
            }
          ],
          "combinator": "and"
        }
      },
      "id": "node-edit-if",
      "name": "ìˆ˜ì • ìœ íš¨?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [880, 1600]
    },
    {
      "parameters": {
        "method": "PATCH",
        "url": "=https://api.notion.com/v1/pages/{{ $json.pageId }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            { "name": "Notion-Version", "value": "2022-06-28" },
            { "name": "Content-Type", "value": "application/json" },
            { "name": "Authorization", "value": "Bearer YOUR_NOTION_API_TOKEN" }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={{ JSON.stringify($json.patchBody) }}"
      },
      "id": "node-edit-notion",
      "name": "ë…¸ì…˜ ìˆ˜ì • PATCH",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [1100, 1520]
    },
    {
      "parameters": {
        "chatId": "={{ $('ìˆ˜ì • íŒŒì‹±').first().json.chatId }}",
        "text": "={{ $('ìˆ˜ì • íŒŒì‹±').first().json.successMsg }}",
        "additionalFields": {}
      },
      "id": "node-edit-success-reply",
      "name": "ìˆ˜ì • ì™„ë£Œ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1320, 1520],
      "credentials": {
        "telegramApi": { "id": "1", "name": "Telegram Bot" }
      }
    },
    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "={{ $json.errorMsg }}",
        "additionalFields": {}
      },
      "id": "node-edit-error-reply",
      "name": "ìˆ˜ì • ì˜¤ë¥˜ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [1100, 1680],
      "credentials": {
        "telegramApi": { "id": "1", "name": "Telegram Bot" }
      }
    },

    {
      "parameters": {
        "chatId": "={{ $json.chatId }}",
        "text": "=ğŸ“ í”„ë¡œì íŠ¸ ëª©ë¡\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nğŸ¯ ë§ˆì¼€íŒ…\n  Â· ìœ íŠœë¸Œ ì±„ë„ ìš´ì˜\n  Â· ì¸ìŠ¤íƒ€ê·¸ë¨ ìš´ì˜\n  Â· ê´‘ê³  ìš´ì˜\n  Â· ìƒí’ˆ ì´¬ì˜/ì½˜í…ì¸ \n\nğŸ“¦ ìƒí’ˆ/ìƒì‚°\n  Â· ì‹œì¦Œ ìƒí’ˆ ê¸°íš\n  Â· DIYí‚¤íŠ¸ ë¼ì¸ì—… í™•ëŒ€\n  Â· ì›ìì¬/ì¬ê³  ê´€ë¦¬\n  Â· ê½ƒ/ê³µì˜ˆ ë ˆí¼ëŸ°ìŠ¤\n\nğŸ›’ ì±„ë„/íŒë§¤\n  Â· ì›¨ë”©ê¸°í”„íŠ¸ ëŸ°ì¹­\n  Â· í™ˆí˜ì´ì§€ ë¦¬ë‰´ì–¼\n  Â· ì‚¬ë°©ë„· ì„¸íŒ…\n\nğŸ’¬ ê³ ê°/CS\n  Â· ì‡¼í•‘ëª° CS ê´€ë¦¬\n  Â· í”Œë«í¼ ë¦¬ë·° ê´€ë¦¬\n\nâš™ï¸ ìš´ì˜/ê´€ë¦¬\n  Â· n8n ìë™í™” êµ¬ì¶•\n  Â· ì°½ê³  ì •ë¦¬\n\nğŸ“Š ê²½ì˜/ì„±ì¥\n  Â· ìê¸°ê°œë°œ\n  Â· ìš´ë™\n  Â· ê°€ê³„ë¶€\n  Â· ì›”ê°„ ë§¤ì¶œ ë¶„ì„\n  Â· ê²½ìŸì‚¬/íŠ¸ë Œë“œ ì¡°ì‚¬\n\nğŸ’¡ ë“±ë¡ ì˜ˆì‹œ\nìœ íŠœë¸Œ - ì˜ìƒí¸ì§‘ @ì˜¤ëŠ˜\nì‡¼í•‘ëª° CS - ì£¼ë¬¸ë¬¸ì˜ @ì˜¤ëŠ˜",
        "additionalFields": {}
      },
      "id": "node-reply-projects",
      "name": "í”„ë¡œì íŠ¸ ëª©ë¡ íšŒì‹ ",
      "type": "n8n-nodes-base.telegram",
      "typeVersion": 1.2,
      "position": [660, 960],
      "credentials": {
        "telegramApi": {
          "id": "1",
          "name": "Telegram Bot"
        }
      }
    }
  ],
  "connections": {
    "TelegramBot": { "main": [[{ "node": "ë©”ì‹œì§€ íŒŒì‹±", "type": "main", "index": 0 }]] },
    "ë©”ì‹œì§€ íŒŒì‹±": { "main": [[{ "node": "ì»¤ë§¨ë“œ ë¼ìš°í„°", "type": "main", "index": 0 }]] },
    "ì»¤ë§¨ë“œ ë¼ìš°í„°": {
      "main": [
        [{ "node": "Gemini AI íŒŒì‹±", "type": "main", "index": 0 }],
        [{ "node": "ì˜¤ëŠ˜ í•  ì¼ ì¡°íšŒ", "type": "main", "index": 0 }],
        [{ "node": "ì•¡ì…˜ ë¶„ê¸°", "type": "main", "index": 0 }],
        [{ "node": "ë°€ë¦° ì—…ë¬´ ì¡°íšŒ (ì»¤ë§¨ë“œ)", "type": "main", "index": 0 }],
        [{ "node": "í”„ë¡œì íŠ¸ ëª©ë¡ íšŒì‹ ", "type": "main", "index": 0 }],
        [{ "node": "Callback ì²˜ë¦¬", "type": "main", "index": 0 }],
        [{ "node": "ì´ë²ˆ ì£¼ ë‚ ì§œ ê³„ì‚°", "type": "main", "index": 0 }],
        [{ "node": "ìˆ˜ì • íŒŒì‹±", "type": "main", "index": 0 }]
      ]
    },
    "Gemini AI íŒŒì‹±": { "main": [[{ "node": "Gemini ì‘ë‹µ íŒŒì‹±", "type": "main", "index": 0 }]] },
    "Gemini ì‘ë‹µ íŒŒì‹±": { "main": [[{ "node": "AI ì„±ê³µ?", "type": "main", "index": 0 }]] },
    "AI ì„±ê³µ?": {
      "main": [
        [{ "node": "AIê²°ê³¼ ë³€í™˜", "type": "main", "index": 0 }],
        [{ "node": "AI í´ë°± íŒŒì„œ", "type": "main", "index": 0 }]
      ]
    },
    "AIê²°ê³¼ ë³€í™˜": { "main": [[{ "node": "í”„ë¡œì íŠ¸ ê²€ìƒ‰", "type": "main", "index": 0 }]] },
    "AI í´ë°± íŒŒì„œ": { "main": [[{ "node": "í”„ë¡œì íŠ¸ ê²€ìƒ‰", "type": "main", "index": 0 }]] },
    "í”„ë¡œì íŠ¸ ê²€ìƒ‰": { "main": [[{ "node": "í”„ë¡œì íŠ¸ ë§¤ì¹­ ê²°ê³¼", "type": "main", "index": 0 }]] },
    "í”„ë¡œì íŠ¸ ë§¤ì¹­ ê²°ê³¼": { "main": [[{ "node": "ìº˜ë¦°ë” ì¡°íšŒ", "type": "main", "index": 0 }]] },
    "ìº˜ë¦°ë” ì¡°íšŒ": { "main": [[{ "node": "ìº˜ë¦°ë” í™•ì¸", "type": "main", "index": 0 }]] },
    "ìº˜ë¦°ë” í™•ì¸": { "main": [[{ "node": "ìº˜ë¦°ë” ì¡´ì¬?", "type": "main", "index": 0 }]] },
    "ìº˜ë¦°ë” ì¡´ì¬?": {
      "main": [
        [{ "node": "ìº˜ë¦°ë” ID í†µí•©", "type": "main", "index": 0 }],
        [{ "node": "ìº˜ë¦°ë” ìƒì„±", "type": "main", "index": 0 }]
      ]
    },
    "ìº˜ë¦°ë” ìƒì„±": { "main": [[{ "node": "ìº˜ë¦°ë” ID í†µí•©", "type": "main", "index": 0 }]] },
    "ìº˜ë¦°ë” ID í†µí•©": { "main": [[{ "node": "í•  ì¼ ìƒì„±", "type": "main", "index": 0 }]] },
    "í•  ì¼ ìƒì„±": { "main": [[{ "node": "í™•ì¸ ë©”ì‹œì§€ í¬ë§·", "type": "main", "index": 0 }]] },
    "í™•ì¸ ë©”ì‹œì§€ í¬ë§·": { "main": [[{ "node": "í™•ì¸ íšŒì‹ ", "type": "main", "index": 0 }]] },
    "ì˜¤ëŠ˜ í•  ì¼ ì¡°íšŒ": { "main": [[{ "node": "ëª©ë¡ í¬ë§·", "type": "main", "index": 0 }]] },
    "ëª©ë¡ í¬ë§·": { "main": [[{ "node": "ëª©ë¡ íšŒì‹ ", "type": "main", "index": 0 }]] },
    "ì•¡ì…˜ ë¶„ê¸°": { "main": [[{ "node": "ì•¡ì…˜ ìŠ¤ìœ„ì¹˜", "type": "main", "index": 0 }]] },
    "ì•¡ì…˜ ìŠ¤ìœ„ì¹˜": {
      "main": [
        [{ "node": "ì™„ë£Œ/ìƒíƒœë³€ê²½ ëª©ë¡ ì¡°íšŒ", "type": "main", "index": 0 }],
        [{ "node": "ì™„ë£Œ/ìƒíƒœë³€ê²½ ëª©ë¡ ì¡°íšŒ", "type": "main", "index": 0 }],
        [{ "node": "ë„ì›€ë§ íšŒì‹ ", "type": "main", "index": 0 }],
        [{ "node": "ì˜¤ë¥˜ íšŒì‹ ", "type": "main", "index": 0 }]
      ]
    },
    "ì™„ë£Œ/ìƒíƒœë³€ê²½ ëª©ë¡ ì¡°íšŒ": { "main": [[{ "node": "ëŒ€ìƒ í˜ì´ì§€ í™•ì¸", "type": "main", "index": 0 }]] },
    "ëŒ€ìƒ í˜ì´ì§€ í™•ì¸": { "main": [[{ "node": "ë…¸ì…˜ ìƒíƒœ ë³€ê²½", "type": "main", "index": 0 }]] },
    "ë…¸ì…˜ ìƒíƒœ ë³€ê²½": { "main": [[{ "node": "ì²˜ë¦¬ê²°ê³¼ í¬ë§·", "type": "main", "index": 0 }]] },
    "ì²˜ë¦¬ê²°ê³¼ í¬ë§·": { "main": [[{ "node": "ì²˜ë¦¬ê²°ê³¼ íšŒì‹ ", "type": "main", "index": 0 }]] },
    "ë°€ë¦° ì—…ë¬´ ì¡°íšŒ (ì»¤ë§¨ë“œ)": { "main": [[{ "node": "ë°€ë¦° ì—…ë¬´ í¬ë§·", "type": "main", "index": 0 }]] },
    "ë°€ë¦° ì—…ë¬´ í¬ë§·": { "main": [[{ "node": "ë°€ë¦° ì—…ë¬´ íšŒì‹ ", "type": "main", "index": 0 }]] },
    "Callback ì²˜ë¦¬": { "main": [[{ "node": "CallbackQuery ì‘ë‹µ", "type": "main", "index": 0 }]] },
    "CallbackQuery ì‘ë‹µ": { "main": [[{ "node": "Notion ìƒíƒœ ë³€ê²½ (Callback)", "type": "main", "index": 0 }]] },
    "Notion ìƒíƒœ ë³€ê²½ (Callback)": { "main": [[{ "node": "ë©”ì‹œì§€ ë²„íŠ¼ ì œê±°", "type": "main", "index": 0 }]] },
    "ì´ë²ˆ ì£¼ ë‚ ì§œ ê³„ì‚°": { "main": [[{ "node": "ì´ë²ˆ ì£¼ í•  ì¼ ì¡°íšŒ", "type": "main", "index": 0 }]] },
    "ì´ë²ˆ ì£¼ í•  ì¼ ì¡°íšŒ": { "main": [[{ "node": "ì£¼ê°„ í¬ë§·", "type": "main", "index": 0 }]] },
    "ì£¼ê°„ í¬ë§·": { "main": [[{ "node": "ì£¼ê°„ íšŒì‹ ", "type": "main", "index": 0 }]] },
    "ìˆ˜ì • íŒŒì‹±": { "main": [[{ "node": "ìˆ˜ì • ìœ íš¨?", "type": "main", "index": 0 }]] },
    "ìˆ˜ì • ìœ íš¨?": {
      "main": [
        [{ "node": "ë…¸ì…˜ ìˆ˜ì • PATCH", "type": "main", "index": 0 }],
        [{ "node": "ìˆ˜ì • ì˜¤ë¥˜ íšŒì‹ ", "type": "main", "index": 0 }]
      ]
    },
    "ë…¸ì…˜ ìˆ˜ì • PATCH": { "main": [[{ "node": "ìˆ˜ì • ì™„ë£Œ íšŒì‹ ", "type": "main", "index": 0 }]] }
  },
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Seoul"
  },
  "tags": [{ "name": "ì—…ë¬´ìë™í™”" }]
}
