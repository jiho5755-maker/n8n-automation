# 쇼핑몰 운영 자동화 시스템 PRD

> **작성일**: 2026-02-19
> **최종 수정**: 2026-02-20 (메이크샵 자체 알림톡 + 챗봇 전략 재수립 + 카카오 채널 보유 반영)
> **상태**: 기술 검증 완료, 서버 배포 대기 중
> **관련 문서**: `AUTOMATION-STRATEGY.md` (전략 상세), `CLAUDE.md` (컨텍스트)

---

## 핵심 정보

**목적**: 메이크샵 D4 쇼핑몰(웨딩기프트/답례품) 1인 운영에서 발생하는 반복 CS 처리, 리뷰 답변, 고객 경험 자동화(미수금/VIP/이탈/휴면)를 n8n으로 자동화하여 운영 부담을 최소화하고 매출을 증대한다. 챗봇은 Phase 1~2에서 미사용, Phase 3+ 안정화 후 카카오 오픈빌더로 선택적 도입.

**사용자**: 메이크샵 D4 쇼핑몰을 혼자 운영하며 자사몰 + 스마트스토어 등 다채널 CS와 마케팅을 동시에 담당하는 1인 사업자.

---

## 사방넷 역할 명확화 (자동화 불필요 영역)

> 사방넷은 2년째 사용 중이며 API 비용(월 5만원) 없이 기존 UI 기능만 활용한다.
> 아래 영역은 메이크샵 + 사방넷 기존 기능으로 이미 충분하므로 n8n 자동화 대상에서 제외한다.

| 영역 | 처리 방식 | n8n 자동화 여부 |
|------|----------|----------------|
| 주문 조회 | 사방넷 + 메이크샵 UI | 제외 |
| 송장 출력 및 등록 | 사방넷 UI | 제외 |
| 재고 통합 관리 | 사방넷 UI | 제외 |
| 배송 처리 | 사방넷 UI | 제외 |
| 교환/반품 처리 | 사방넷 + 메이크샵 UI | 제외 |
| 쿠팡 관련 모든 처리 | 사방넷 (쿠팡 Wing API와 중복 불가) | 전면 제외 |

---

## 기술적 제약 및 리스크

| 제약 | 영향 | 대응 방안 |
|------|------|----------|
| **채널톡 무료 플랜: Webhook/Open API 미지원** | 타 채널(톡톡/카카오/인스타) CS 자동 수신 불가 | 자사몰 1:1 게시판 API → n8n 자동 수집. 타 채널 수동. 크롤링 동기화 방안 별도 검토 |
| **채널톡 크롤링 동기화 방안 (연구 필요)** | 채널톡 UI 내 타 채널 문의 수동 저장 비효율 | 방안 A: 채널톡 앱 UI Puppeteer 자동화(비공식). 방안 B: 브라우저 확장프로그램으로 채널톡 대화 자동 추출. 방안 C: 판매자 각 채널 직접 API(톡톡 챗봇 API 등) 별도 연동 |
| **네이버 커머스 API: 리뷰 미지원 확정** | 스마트스토어 리뷰 자동 수집/답변 등록 영구 불가 | API 전체 카테고리(8개) 공식 문서 확인 결과 리뷰 API 없음 확정. AI 초안 생성 → 텔레그램 → 수동 등록 방식 유지 |
| **쿠팡 Wing API: 사방넷 연동 중복** | 쿠팡 직접 API 연동 불가 | 쿠팡은 사방넷 기존 기능으로 처리. PRD에서 전면 제외 |
| **사방넷 API: 월 5만원 유료** | API 연동 비용 부담 | 사방넷 UI 기능만 활용. API 미사용 |
| **쿠팡 크롤링: robots.txt 차단** | 경쟁사 모니터링 불가 | 네이버 검색 API만 활용. 쿠팡은 수동 모니터링 |
| **Notion API: 초당 3회 제한** | 대량 조회 시 속도 제한 | retry/backoff 로직 적용 |
| **메이크샵 API: 시간당 500회 제한** | API 호출 예산 관리 필요 | 시간대별 분산 호출, 일일 300~400회 이내 유지 |
| **네이버 커머스 API: Rate Limit (Token Bucket)** | 초당 동시 요청 초과 시 429 오류 | 응답 헤더의 Remaining 값 확인 후 조절, 버스트 모드 2배 한도 활용 |
| **네이버 커머스 API: bcrypt 전자서명 필수** | 일반 OAuth와 달리 매 요청 전 서명 생성 필요 | n8n Code 노드에서 bcrypt 라이브러리로 서명 생성 → HTTP Request로 토큰 발급 |

### 자사몰 챗봇 전략 비교: Typebot vs 카카오 오픈빌더 vs 챗봇 미사용

> 조사일: 2026-02-20 | 입문자(1인 운영) 기준, 일 CS 4~10건 환경에서 최적의 챗봇 전략 선정

#### 3가지 옵션 상세 비교

| 비교 항목 | **A. Typebot (self-hosted)** | **B. 카카오 오픈빌더** | **C. 챗봇 미사용 (간소화)** |
|----------|---------------------------|---------------------|--------------------------|
| **동작 위치** | 자사몰 웹 위젯 (모든 페이지) | 카카오톡 앱 내에서만 | - |
| **FAQ 자동응대** | O (드래그앤드롭 시나리오) | O (지식+ 엑셀 업로드) | X (메이크샵 FAQ 게시판으로 대체) |
| **AI 자유질문** | O (OpenAI 직접 연동) | 제한적 (스킬서버 5초 타임아웃) | X |
| **배송조회 연동** | O (n8n Webhook → API) | O (스킬서버 → n8n, 5초 제한) | X (고객이 직접 택배사 사이트 조회) |
| **상담원 전환** | 채널톡 자동 열림 (JS 연동) | 카카오톡 내 수동 안내 | 채널톡 버튼 직접 클릭 |
| **서버 리소스** | **1.5GB** (Builder 1GB + Viewer 512MB) | **0GB** (카카오 인프라) | **0GB** |
| **초기 구축 난이도** | ★★★★☆ (Docker 배포 + 시나리오 + JS 연동) | ★★★☆☆ (오픈빌더 UI + 발화 패턴 설계) | ★☆☆☆☆ (설정 없음) |
| **유지보수 난이도** | ★★★☆☆ (Docker 업데이트 + 시나리오 수정) | ★★☆☆☆ (웹 UI에서 수정) | ★☆☆☆☆ |
| **비용** | 0원 (self-hosted) + 서버 리소스 | 0원 (2022.09 무료 전환 완료) | 0원 |
| **도메인 필요** | chat/bot 서브도메인 2개 | 불필요 | 불필요 |
| **카카오 채널 필요** | 불필요 | 필수 (보유 완료) | 불필요 |

#### 입문자 관점 난이도 상세

| 단계 | **Typebot** | **카카오 오픈빌더** | **챗봇 미사용** |
|------|------------|-------------------|----------------|
| 1. 환경 구축 | Docker Compose + Nginx 서브도메인 2개 + HTTPS + PostgreSQL 연동 | i.kakao.com 가입 + 채널 연결 (웹 브라우저만 필요) | 없음 |
| 2. 챗봇 설계 | 드래그앤드롭 에디터로 대화 흐름 구성 (직관적이나 분기가 많아지면 복잡) | 시나리오 → 블록 → 인텐트 구조 이해 필요. 발화 패턴 100개 권장 (ML 학습용) | FAQ 게시판에 질문/답변 작성 |
| 3. API 연동 | n8n Webhook URL 입력만으로 연동 | 스킬서버 URL 입력 (동일하나 **5초 타임아웃 고정**, OpenAI 호출 시 초과 가능) | 불필요 |
| 4. 프론트 삽입 | 메이크샵 공통 HTML에 JS 삽입 + 채널톡 전환 코드 | 카카오톡 앱에서 자동 동작 (삽입 불필요) | 채널톡 기본 위젯 유지 |
| 5. 테스트 | Typebot 미리보기 + 실제 위젯 + 채널톡 전환 테스트 | 오픈빌더 시뮬레이터 + 카카오톡에서 실제 테스트 | 불필요 |

#### 일 CS 4~10건 환경에서의 실효성 분석

| 지표 | **Typebot** | **카카오 오픈빌더** | **챗봇 미사용** |
|------|------------|-------------------|----------------|
| 자동 해결 예상 | 80~90% (3~9건/일) | 50~70% (카카오톡으로 문의하는 고객만 대상) | 0% |
| 절약 시간/일 | ~20~40분 | ~10~20분 | 0분 |
| 투자 시간 (초기) | ~15~20시간 (Docker + 시나리오 + 연동) | ~8~12시간 (오픈빌더 학습 + 시나리오) | 0시간 |
| ROI 회수 기간 | ~4~6주 | ~3~4주 | 즉시 |
| **서버 부담** | **높음** (8GB 중 1.5GB 점유 = 19%) | **없음** | **없음** |

#### 결론 및 추천

> **추천: C → B 단계적 도입 (챗봇 미사용으로 시작 → 안정화 후 카카오 오픈빌더 추가)**
>
> **이유**:
> 1. **일 4~10건 CS에 챗봇 구축은 과투자** — 절약 시간 대비 초기 투자 시간이 높음
> 2. **입문자에게 Typebot Docker 관리는 부담** — 서버 1.5GB 점유 + 유지보수 필요
> 3. **카카오 오픈빌더는 서버 무부담** — 카카오 채널 이미 보유, 나중에 간단히 추가 가능
> 4. **Phase 1은 n8n 자동화에 집중하는 것이 효율적** — CS 기록/알림/템플릿 추천이 더 높은 ROI
>
> **단계별 전략**:
> - **Phase 1~2 (당장)**: 챗봇 없이 운영. 채널톡 라이브챗 + 메이크샵 FAQ 게시판 강화 + n8n 자동 알림/기록
> - **Phase 3+ (안정화 후)**: 카카오 오픈빌더 지식+(FAQ) 구축. 엑셀 업로드만으로 FAQ 챗봇 완성 → 서버 부담 0
> - **필요 시**: 자사몰 웹 위젯이 반드시 필요해지면 그때 Typebot 도입 검토

---

### 채널톡 대안 분석: 카카오톡 채널 + 카카오 i 오픈빌더 챗봇

> 조사일: 2026-02-19 | 채널톡 무료 플랜 제약 극복 방안으로 카카오 생태계 활용 가능성 분석

#### 카카오 i 오픈빌더 챗봇 (무료 전환됨, 2022.09.01~)

| 항목 | 내용 |
|------|------|
| **비용** | **완전 무료** (2022년 9월부터 일반 상품 과금 없음. 기존: 5만 건 초과 시 건당 30~40원) |
| **챗봇 구조** | 시나리오 → 블록(인텐트) 기반. 사용자 발화 패턴 + 엔티티(용어 사전) + ML+ 자동 학습 |
| **응답 유형** | 텍스트형(1,000자), 이미지형(10개), 카드형(이미지+텍스트+버튼, 10개), 리스트 메뉴(하단 슬라이드) |
| **FAQ 자동응대** | **지식+(Knowledge+)**: 엑셀 파일 업로드만으로 FAQ 챗봇 구축 가능 (별도 개발 불필요) |
| **스킬서버(Webhook)** | HTTP POST → JSON 응답. 외부 API 연동 가능 (n8n Webhook 노드와 직접 연결 가능) |
| **스킬 타임아웃** | 고정 5초 (5초 내 응답 필수 → 아래 대응 방안 참조) |

> **5초 타임아웃 대응 방안**: 오픈빌더 스킬서버는 5초 내 HTTP 응답 필수 (변경 불가).
> - **경량 응답 우선**: n8n Webhook에서 외부 API 호출(OpenAI 등)이 필요한 경우, 즉시 "확인 중입니다" 안내 메시지 반환 후 비동기 처리
> - **캐시 활용**: 자주 묻는 FAQ는 n8n 내부 변수 또는 DB에 캐싱하여 API 호출 없이 즉시 응답 (목표: < 1초)
> - **OpenAI 호출 분리**: AI 답변이 필요한 경우 "잠시만 기다려주세요" 즉시 반환 → 별도 n8n 워크플로우에서 AI 생성 후 카카오 알림톡으로 후속 전달
> - **모니터링**: n8n Webhook 응답 시간 로깅 → 5초 초과 비율 추적하여 병목 개선
| **특수 블록** | 웰컴 블록(첫 진입 시 1회), 폴백 블록(미인식 발화), 되묻기 기능 |
| **배포** | 카카오톡 채널과 연결하여 카카오톡 앱 내에서 챗봇 동작 |

#### 채널톡 무료 플랜 현황 (2025.11.28 가격제 개편 반영)

| 항목 | 무료 플랜 | 얼리 스테이지 (유료) | 그로스 (유료) |
|------|----------|-------|-------|
| **라이브챗** | O | O | O |
| **멀티채널 통합** (카카오톡/인스타/네이버 톡톡) | O | O | O |
| **대화 내역** | 30일 | 무제한 | 무제한 |
| **이벤트 내역** | 7일 | 90일 | 90일 |
| **고객정보 열람/수정** | X | O | O |
| **Webhook/API** | X | O | O |
| **서포트봇 (자동화)** | X | X | O |
| **ALF AI 챗봇** | X | X | O (3만원 상당 기본 제공) |
| **데이터 다운로드** | X | O | O |

#### 비교 분석: 채널톡 vs 카카오톡 채널 챗봇

| 비교 항목 | 채널톡 (무료) | 카카오톡 채널 + 오픈빌더 (무료) |
|----------|-------------|--------------------------|
| **자사몰 위젯** | O (JS SDK) | X (카카오톡 앱에서만 동작) |
| **멀티채널 통합** | **O** (톡톡/카카오/인스타 통합) | X (카카오톡 채널만) |
| **챗봇 자동응대** | X (무료 플랜 미지원) | **O** (시나리오/FAQ/스킬서버) |
| **AI 챗봇** | X (그로스 유료만) | 스킬서버로 n8n+OpenAI 연동 가능 |
| **Webhook** | X (무료 미지원) | **O** (스킬서버 = Webhook) |
| **고객 정보** | 기본만 (무료 제한) | 카카오톡 프로필 정보 |
| **알림톡 연동** | X | **O** (카카오 생태계, 메이크샵 자체 알림톡과 동일 카카오 채널 사용) |
| **운영 채널** | 자사몰 웹 + 모바일앱 | 카카오톡 앱 내 |
| **설치 난이도** | 쉬움 (SDK 삽입) | 중간 (채널 개설 + 오픈빌더 설정) |

#### 결론: 채널톡 유지 + 카카오톡 채널 챗봇 병행 (대체 아닌 보완)

```
[전략: 단계적 채널 운영]

Phase 1~2 (당장):
  자사몰 → 채널톡 라이브챗 (기존 유지) + 메이크샵 FAQ 게시판 강화
  전 채널 → n8n 자동 기록/알림/템플릿 추천 (핵심)
  알림톡 → 메이크샵 자체 알림톡 (카카오 채널 보유 완료)

Phase 3+ (안정화 후, 선택):
  카카오톡 채널 → 카카오 i 오픈빌더 챗봇 (FAQ 자동응대)
      → 지식+(FAQ) 엑셀 업로드만으로 구축 (서버 부담 0)
      → 스킬서버 → n8n Webhook → 동일한 CS 워크플로우 연동

필요 시:
  자사몰 → Typebot 챗봇 위젯 (Docker self-hosted, 서버 1.5GB 추가 필요)

채널톡 (무료 유지):
  └── 멀티채널 통합 허브 (톡톡/인스타 등 수신)
      → 자사몰 상담원 연결 수신처
      → 무료 플랜 유지 (유료 전환 불필요)
```

> **챗봇을 Phase 1에서 제외하는 이유**: 일 CS 4~10건 환경에서 챗봇 구축(15~20시간)은 과투자. n8n 자동 기록/알림/템플릿 추천이 더 높은 ROI를 제공하며, 메이크샵 FAQ 게시판 + 채널톡 라이브챗으로 충분히 운영 가능.

> **카카오톡 채널 챗봇 도입 시기**: Phase 3+ (n8n 자동화 안정화 후). 카카오톡 채널은 이미 보유 중이므로 오픈빌더 연결만 하면 됨. 지식+(FAQ) 엑셀 업로드 방식으로 구축 난이도 낮음.

---

### 채널별 자동화 가능 범위

| 채널 | CS 수신 | CS 답변 등록 | 리뷰 수집 | 리뷰 답변 등록 |
|------|---------|------------|---------|--------------|
| **자사몰 (메이크샵)** | 1:1 게시판 API 자동 수집 + 채널톡 라이브챗 | API 자동 | API 자동 | API 자동 |
| **스마트스토어** | 커머스 API 자동 (상품 문의 + 고객 문의 조회) | API 자동 | **미지원 확정** | **미지원 확정** → AI 초안 + 텔레그램 + 수동 등록 |
| **네이버 톡톡** | 채널톡 통합 (수동 확인) | 수동 | - | - |
| **쿠팡** | 사방넷으로 관리 | 사방넷으로 관리 | 제외 | 제외 |
| **카카오/인스타** | 채널톡 통합 (수동 확인) | 수동 | - | - |

---

## 사용자 여정

```
[자사몰 고객 경험 — CS 자동화 (Phase 1~2, 챗봇 없이)]

1. 고객 문의 발생
   ├── 자사몰 1:1 게시판 → n8n 스케줄(매 30분) 자동 수집
   ├── 채널톡 라이브챗 → 운영자 직접 답변 (실시간)
   └── FAQ 페이지 → 자주 묻는 질문 자체 해결

2. n8n 자동 처리
   ↓ 1:1 게시판 CS 수신 → 키워드 분류 → 노션 CS DB 기록
   ↓ 텔레그램 알림 (CS 내용 + 추천 답변 템플릿)
   ↓ 운영자가 채널톡/1:1 게시판에서 답변

[Phase 3+ 선택] 카카오 오픈빌더 또는 Typebot 챗봇 추가 시:
   → 자동 FAQ 응대 (80~90%) + 배송조회 + 상담원 전환

---

[자사몰 고객 경험 — 미수금 관리]

1. 무통장 주문 발생 → n8n 스케줄 매 1시간 감시
   ↓

   [72시간 내 입금 확인] → 메이크샵 API 입금 처리 → 알림톡 출고 안내
   [72시간 미입금]       → 메이크샵 API 자동 취소 → 알림톡 취소 안내
                         → 텔레그램 운영자 알림

---

[리뷰 자동화 — 매일 스케줄]

1. n8n 스케줄 → 자사몰 메이크샵 API 리뷰 수집
   ↓ AI 감성 분석 및 분류

   [별점 4~5 + 일반 칭찬] → AI 자동 답변 → API 자동 등록 → 노션 기록 → 종료
   [별점 4~5 + 개선요청]  → AI 초안 생성 → 텔레그램 승인 요청 ↓
   [별점 1~3 부정 리뷰]   → 텔레그램 긴급 알림 + AI 참고안 ↓

2. 운영자 → 텔레그램에서 [이대로 등록] / [수정] / [직접 작성] 선택 → API 자동 등록

3. 스마트스토어 리뷰 → AI 답변 초안 생성 → 텔레그램 발송
   → 운영자가 판매자센터에서 수동 등록 (네이버 커머스 API 리뷰 미지원 확정, 수동 등록 영구 유지)

---

[리뷰 작성 유도 — 배송완료 D+7]

1. n8n 스케줄 → 메이크샵 API 배송완료 D+7 주문 조회
   → 리뷰 미작성 고객 → 알림톡 리뷰 요청 + 적립금 보상 안내 자동 발송

---

[고객 경험 고도화 — 매일/매월 스케줄]

VIP 관리: 월 1회 → 주문 통계 조회 → VIP 기준 충족 고객 자동 승급
          → 축하 알림톡 + 쿠폰/적립금 자동 지급 → 텔레그램 알림

장바구니 이탈: 매일 10:00 → 24시간 이탈 감지 → 알림톡 + 쿠폰 자동 발송

휴면 재활성화: 매일 스케줄 → 휴면 전환 예정 D-7 → 복귀 할인 쿠폰 + 알림톡

---

[SNS 리마인더 — 매일/주간 스케줄]

1. n8n 스케줄 → 노션 콘텐츠 캘린더 DB 조회
   ↓ 내일 발행 예정 → 텔레그램 리마인더 (매일 21:00)
   ↓ 미완성 콘텐츠 → 텔레그램 경고 (매일 21:00)
   ↓ 주간 계획 현황 → 텔레그램 발송 (매주 일요일 20:00)

   [좋은 리뷰 감지 시] → 텔레그램으로 SNS 콘텐츠 활용 자동 추천

---

[경쟁사 모니터링 — 매일 09:00, 최후순위]

1. n8n 스케줄 → 네이버 검색 API(쇼핑) 가격/순위 수집
   (쿠팡 제외: 크롤링 차단)
   [변동 없음] → 노션 가격 이력 DB 기록만 (알림 없음)
   [변동 감지] → 텔레그램 알림 → 운영자 대응 판단
```

---

## 기능 명세

### Phase 1 — MVP: 자사몰 CS + 리뷰 + 미수금 (최우선, 1a/1b 분리 구현)

| ID | 기능명 | 설명 | 필수 이유 | 관련 페이지/도구 |
|----|--------|------|---------|----------------|
| **F004** | CS 노션 DB 기록 | 메이크샵 1:1 게시판 API 자동 수집 + 수동 기록 → 노션 CS 문의 DB | 영구 CS 이력 보관 (채널톡 무료 기록 제한 극복) | n8n CS 워크플로우, 노션 CS 문의 DB |
| **F005** | CS 텔레그램 알림 + 템플릿 추천 | CS 수신 시 텔레그램 즉시 알림 + 키워드 매칭 답변 템플릿 자동 추천 | 답변 시간 단축, 일관된 품질 유지 | n8n CS 워크플로우, 노션 CS 템플릿 DB |
| **F006** | 미답변 CS 추적 알림 | 노션 CS DB 기준 1시간/3시간/6시간 경과 미답변 건 단계적 텔레그램 알림 | 응답 누락 방지 | n8n CS 워크플로우, 노션 CS 문의 DB |
| **F007** | CS 템플릿 DB 관리 | 노션 CS 템플릿 DB에 초기 18개 답변 템플릿 구축 + 키워드 매칭 + 변수 치환 + 사용 횟수 통계 | F005 템플릿 추천의 데이터 기반 | 노션 CS 템플릿 DB |
| **F008** | 자사몰 리뷰 AI 자동 답변 | 메이크샵 API 리뷰 수집 → AI 감성 분석 → 별점 4~5 일반 칭찬 API 자동 등록 | 자사몰 리뷰 답변 완전 자동화 | n8n 리뷰 워크플로우, 노션 리뷰 DB |
| **F009** | 부정 리뷰 / 확인 필요 리뷰 알림 | 별점 1~3 또는 개선요청 포함 리뷰 → AI 초안 생성 → 텔레그램 긴급 알림 | 부정 리뷰 빠른 대응으로 브랜드 평판 관리 | n8n 리뷰 워크플로우, 노션 리뷰 DB |
| **F010** | 미수금 자동 관리 | 무통장 72시간 미입금 → 알림톡 알림 → 자동 취소. 입금 확인 시 출고 알림톡 안내 | 미입금 수동 관리 시간 절약, 미처리 방지 | n8n 미수금 워크플로우 |
| **F011** | 일일/주간 리포트 | 매일 21:00 CS 현황 + 리뷰 현황 리포트, 매주 월요일 리뷰 분석 리포트 텔레그램 발송 | 운영 성과 수치 확인 | n8n 리포트 워크플로우 |

### Phase 2 — 고객 경험 고도화 (핵심 매출 증대)

> 이 섹션이 매출과 재구매율에 직결되는 핵심 자동화다.

| ID | 기능명 | 설명 | 효과 | 관련 페이지/도구 |
|----|--------|------|------|----------------|
| **F020** | VIP 고객 자동 판별 및 승급 | 월 1회 회원 주문 통계 조회 → VIP 기준 충족 시 그룹 자동 승급 → 축하 알림톡 + 쿠폰/적립금 자동 지급 | 재구매율 향상, 고객 로열티 강화 | n8n 고객경험 워크플로우 |
| **F021** | 장바구니 이탈 유도 | 매일 10:00 장바구니 24시간 이탈 고객 조회 → 알림톡 + 쿠폰 자동 발송 | 장바구니 이탈 10~15% 추가 전환 | n8n 고객경험 워크플로우 |
| **F022** | 휴면 고객 재활성화 | 휴면 전환 예정 D-7 → 복귀 할인 쿠폰 + 알림톡 자동 발송 | 휴면 전환 방지 5~10% | n8n 고객경험 워크플로우 |
| **F023** | 주문 상태 알림톡 자동 알림 | 입금확인/배송시작/배송완료 등 주문 상태 변경 시 메이크샵 자체 알림톡 자동 발송 (관리자 설정, n8n 불필요) | 배송 관련 CS 30~40% 자연 감소 | 메이크샵 관리자 설정 |
| **F024** | 리뷰 작성 유도 | 배송완료 D+7 리뷰 미작성 고객 → 알림톡 + 적립금 보상 안내 자동 발송 | 리뷰 작성률 2~3배 향상 | n8n 리뷰 워크플로우 |
| **F025** | 혜택 자동 지급 시스템 | 이벤트 조건 충족(구매횟수/금액) 시 쿠폰/적립금/포인트 자동 발급 | 고객 만족도 및 재방문율 향상 | n8n 고객경험 워크플로우 |

### Phase 3 — 마케팅 자동화

| ID | 기능명 | 설명 | 관련 페이지/도구 |
|----|--------|------|----------------|
| **F030** | SNS 포스팅 리마인더 | 노션 콘텐츠 캘린더 기반 내일 발행 예정 알림 + 미완성 경고 + 주간 플래닝 알림 | n8n SNS 워크플로우, 노션 콘텐츠 캘린더 DB |
| **F031** | 리뷰→SNS 콘텐츠 자동 제안 | 좋은 리뷰(별점 5 + 사진) 감지 시 SNS 콘텐츠 활용 텔레그램 자동 추천 | n8n 리뷰 워크플로우, n8n SNS 워크플로우 |
| **F032** | 반복 CS → 상세페이지 개선 인사이트 | 월 1회 반복 문의 패턴 분석 → 상세페이지 개선 제안 텔레그램 발송 | n8n 리포트 워크플로우, 노션 CS 문의 DB |
| **F033** | SEO 자동 최적화 | 키워드 트렌드 반영 상품 SEO 자동 등록 (메이크샵 상품 SEO API) | n8n 마케팅 워크플로우 |
| **F034** | 프로모션 자동 관리 | 노션 프로모션 캘린더 → 기획전 자동 생성/종료 (메이크샵 기획전 API) | n8n 마케팅 워크플로우, 노션 콘텐츠 캘린더 DB |

### Phase 4 — 스마트스토어 연동 확산

| ID | 기능명 | 설명 | 관련 페이지/도구 |
|----|--------|------|----------------|
| **F040** | 스마트스토어 문의 AI 자동 답변 | 네이버 커머스 API 상품 문의 + 고객 문의 조회 → AI 답변 생성 → API 자동 등록 | n8n CS 워크플로우 |
| **F041** | 스마트스토어 부정 리뷰 즉시 알림 | 스마트스토어 판매자센터에서 운영자가 리뷰 수동 확인 시 부정 리뷰 발견 → 텔레그램 긴급 알림 (네이버 커머스 API 리뷰 미지원 확정으로 자동 수집 불가) | n8n 리뷰 워크플로우 |
| **F042** | 스마트스토어 리뷰 AI 초안 보조 | 운영자가 스마트스토어 리뷰 내용을 텔레그램에 전달하면 AI가 답변 초안 생성 → 판매자센터에서 수동 등록 (리뷰 API 미지원 확정, 자동화 불가) | n8n 리뷰 워크플로우 |
| **F043** | 리뷰 DB 감성 분석 및 키워드 트렌드 | 누적 리뷰 데이터 기반 감성 분석, 키워드 트렌드, 채널별 비교 분석 | n8n 리포트 워크플로우, 노션 리뷰 DB |

### Phase 5 — 경쟁사 모니터링 (최후순위)

| ID | 기능명 | 설명 | 관련 페이지/도구 |
|----|--------|------|----------------|
| **F050** | 경쟁사 가격 모니터링 | 네이버 검색 API(쇼핑)로 키워드별 상위 상품 가격/순위 매일 수집 → 변동 시 텔레그램 알림 | n8n 경쟁사 워크플로우, 노션 경쟁사 DB |

### Phase 3+ 선택 도입: 챗봇 (카카오 오픈빌더 또는 Typebot)

> Phase 1~2 안정화 후, 필요성이 입증되면 선택적으로 도입. 일 CS 4~10건 환경에서는 챗봇 없이도 운영 가능.

| ID | 기능명 | 설명 | 관련 도구 |
|----|--------|------|----------|
| **F001** | 카카오 오픈빌더 FAQ 챗봇 (우선 추천) | 카카오톡 채널에서 지식+(FAQ) 기반 자동응대. 서버 자원 불필요, 엑셀 업로드로 구축 | 카카오 i 오픈빌더, n8n 스킬서버 |
| **F002** | Typebot 자사몰 위젯 챗봇 (필요 시) | 자사몰 웹 위젯 FAQ + 배송조회 + 채널톡 전환. Docker self-hosted 필요 (1.5GB) | Typebot, n8n Webhook |
| **F003** | 배송 추적 챗봇 연동 | 챗봇에서 주문번호 입력 → n8n → 메이크샵 API → 택배사 추적 → 배송 상태 반환 | F001 또는 F002 + n8n |

### MVP 이후 제외 기능

- 사방넷/쿠팡 API 직접 연동 (사방넷 중복 불가, 유료)
- 채널톡 유료 전환 전 타 채널 CS 전자동화 (Webhook 미지원)
- 서버 헬스체크, n8n 워크플로우 자동 백업 (나중에 추가)

---

## 메뉴/도구 구조

```
쇼핑몰 운영 자동화 시스템 구성도

[자사몰 고객 접점 — Phase 1~2]
├── 채널톡 라이브챗 (상담원 직접 답변, 기존 유지)
├── 메이크샵 1:1 게시판 (고객 문의 접수)
├── 메이크샵 FAQ 게시판 (자주 묻는 질문 자체 해결)
└── [Phase 3+] 카카오 오픈빌더 챗봇 또는 Typebot 위젯 (선택)

[Phase 1 — CS 처리]
├── 자사몰 CS (메이크샵 1:1 게시판 API → n8n 스케줄 자동 수집)
│   └── 기능: F004 (노션 자동 기록), F005 (텔레그램 알림 + 템플릿 추천)
├── 타 채널 CS (채널톡에서 확인 → 노션 수동 기록)
│   └── 기능: F004 (수동 기록)
└── 미답변 추적 (매 1시간 스케줄 — 노션 CS DB 조회)
    └── 기능: F006 (단계적 알림)

[Phase 1b — 리뷰 관리]
├── 자사몰 리뷰 (메이크샵 API 자동 수집 + AI 자동 답변 등록)
│   └── 기능: F008 (AI 자동 답변), F009 (부정 리뷰 알림)
└── 리포트 (매일 21:00)
    └── 기능: F011 (CS + 리뷰 일일 리포트)

[Phase 2 — 리뷰 유도 + 고객 경험]
└── 리뷰 유도 (배송완료 D+7)
    └── 기능: F024 (알림톡 + 적립금 안내)

[Phase 4 — 스마트스토어 리뷰 확산]
├── 스마트스토어 리뷰 (수동 확인 + AI 답변 초안 보조 — 리뷰 API 미지원 확정)
│   └── 기능: F041 (부정 리뷰 알림), F042 (AI 초안 보조)

[Phase 1 — 미수금 관리]
└── 무통장 주문 감시 (매 1시간 스케줄)
    └── 기능: F010 (72시간 미입금 자동 취소, 입금 확인 출고 알림톡)

[Phase 2 — 고객 경험 고도화]
├── VIP 자동 관리 (월 1회 스케줄)
│   └── 기능: F020 (주문 통계 → 자동 승급 → 혜택 지급)
├── 장바구니 이탈 유도 (매일 10:00)
│   └── 기능: F021 (24시간 이탈 감지 → 알림톡 + 쿠폰)
├── 휴면 재활성화 (매일 스케줄)
│   └── 기능: F022 (D-7 쿠폰 + 알림톡)
├── 주문 상태 알림톡 알림 (이벤트 기반)
│   └── 기능: F023 (입금/배송/완료 알림톡)
└── 혜택 자동 지급 (이벤트 기반)
    └── 기능: F025 (쿠폰/적립금/포인트 자동 발급)

[Phase 3 — 마케팅]
├── SNS 리마인더 (매일 21:00 + 매주 일요일 20:00)
│   └── 기능: F030 (발행 예정 알림), F031 (리뷰→콘텐츠 제안)
├── 인사이트 리포트 (매월 1일)
│   └── 기능: F032 (반복 CS → 상세페이지 개선 제안)
├── SEO 자동화 (주기 설정)
│   └── 기능: F033 (상품 SEO 자동 등록)
└── 프로모션 관리 (노션 캘린더 기반)
    └── 기능: F034 (기획전 자동 생성/종료)

[Phase 4 — 스마트스토어 확산]
├── 스마트스토어 문의 AI 답변 (매일 스케줄)
│   └── 기능: F040 (커머스 API → AI → 자동 등록)
└── 스마트스토어 리뷰 AI 보조 (수동 트리거 — 리뷰 API 미지원 확정)
    └── 기능: F041 (부정 리뷰 알림), F042 (AI 초안 보조)

[Phase 5 — 경쟁사 모니터링, 최후순위]
└── 네이버 쇼핑 가격 수집 (매일 09:00)
    └── 기능: F050 (변동 감지 + 노션 기록)

[운영자 관리 도구]
├── n8n 워크플로우 관리 (n8n.도메인.com)
│   └── 모든 자동화 워크플로우 구성/실행 관리
├── [Phase 3+] 카카오 오픈빌더 (i.kakao.com) 또는 Typebot 빌더 (chat.도메인.com)
│   └── 기능: F001 (챗봇 시나리오 관리, 선택 도입 시)
└── 노션 DB 대시보드
    └── 기능: F004, F007, F008 (CS/템플릿/리뷰 DB 관리)

[운영자 알림 수신 — 텔레그램 @Pressco21_bot]
├── CS 알림 (즉시) — F005, F006
├── 리뷰 알림 (즉시 + 일일) — F008, F009, F011
├── 미수금 알림 (이벤트 기반) — F010
├── 고객 경험 알림 (이벤트 기반) — F020~F025
└── 리포트 (매일 21:00 — F011, Phase 1b) + (매월 — F032, Phase 3)
```

---

## 페이지별 상세 기능

### [Phase 3+ 선택] Typebot 챗봇 (bot.도메인.com — 자사몰 위젯으로 삽입)

> **Phase 1~2에서는 미구현**. 안정화 후 자사몰 웹 위젯이 필요해지면 도입 검토.
> **구현 기능:** `F002`, `F003` | **진입:** 자사몰 페이지 채팅 버튼 클릭

| 항목 | 내용 |
|------|------|
| **역할** | 자사몰 고객의 1차 CS 접점. FAQ 80~90% 자동 해결 + 배송 조회 + 채널톡 연결 허브 |
| **진입 경로** | 자사몰 모든 페이지 우측 하단 채팅 버튼 클릭 (메이크샵 공통 HTML 삽입) |
| **사용자 행동** | 카테고리 버튼 선택 (상품정보/배송조회/주문결제/교환반품/상담원연결) 또는 자유 텍스트 질문 입력 |
| **주요 기능** | - 카테고리별 FAQ 자동 답변 트리 (상품구성/사이즈/대량주문/커스텀/포장 등)<br>- 배송 조회: 주문번호 입력 → n8n Webhook → 메이크샵 주문 조회 API(송장번호 추출) → 택배사 추적 API → 배송 상태 반환<br>- AI 자유 질문: n8n Webhook → OpenAI → FAQ에 없는 질문 답변<br>- **상담원 연결** 버튼: Typebot 닫힘 + `ChannelIO('openChat')` JavaScript 실행으로 채널톡 자동 열림<br>- 챗봇 대화 이력 n8n으로 전송 (노션 CS DB 기록 + 텔레그램 알림 트리거) |
| **다음 이동** | FAQ 해결 → 대화 종료 / 상담원 연결 → 채널톡 라이브챗 전환 |

---

### n8n CS 자동화 워크플로우 (n8n.도메인.com)

> **구현 기능:** `F004`, `F005`, `F006`, `F007` | **실행:** Webhook 수신 + 스케줄 트리거

| 항목 | 내용 |
|------|------|
| **역할** | 자사몰 CS 자동 수집/기록 + 전 채널 미답변 추적 + CS 템플릿 추천 엔진 |
| **진입 경로** | (1) 메이크샵 1:1 게시판 API 스케줄 조회 (매 30분) (2) 매 1시간 스케줄 트리거 (미답변 추적) (3) [Phase 3+] 챗봇 Webhook 수신 |
| **사용자 행동** | 자사몰 CS: 1:1 게시판 자동 수집. 타 채널 CS: 운영자가 채널톡에서 확인 후 노션에 수동 기록 |
| **주요 기능** | - [자동] 자사몰 1:1 게시판 CS: 메이크샵 API 조회 → 키워드 분류 → 노션 CS DB 기록 → 텔레그램 알림 + 템플릿 추천<br>- [자동] 미답변 추적: 1시간/3시간/6시간 경과 시 단계적 텔레그램 경고<br>- [자동] 매일 21:00 CS 일일 리포트 (접수/완료/미답변/채널별/유형별/평균응답시간)<br>- [자동] 월 1회 반복 문의 패턴 분석 → 상세페이지 개선 인사이트 텔레그램 발송 (F032)<br>- [수동] 타 채널 CS: 운영자가 노션에 직접 기록 |
| **다음 이동** | 텔레그램 알림 수신 후 운영자가 채널톡 앱에서 직접 답변 처리 |

---

### n8n 미수금 관리 워크플로우 (n8n.도메인.com)

> **구현 기능:** `F010` | **실행:** 매 1시간 스케줄 트리거

| 항목 | 내용 |
|------|------|
| **역할** | 무통장 주문의 입금 여부를 자동 감시하여 미입금 취소와 입금 확인 출고 안내를 자동화 |
| **진입 경로** | 매 1시간 n8n 스케줄 트리거 |
| **사용자 행동** | 자동 실행. 운영자는 텔레그램 알림 수신 후 확인만 함 |
| **주요 기능** | - [자동] 메이크샵 API 무통장 주문 목록 조회<br>- [자동] 72시간 이내 입금 확인 → 메이크샵 API 입금 처리 → 고객에게 출고 안내 알림톡 (메이크샵 send_sms API)<br>- [자동] 72시간 미입금 → 메이크샵 API 주문 자동 취소 → 고객에게 취소 안내 알림톡 (메이크샵 send_sms API)<br>- [자동] 처리 결과 텔레그램 운영자 알림 (입금 확인/미입금 취소 건수 요약) |
| **다음 이동** | 텔레그램 알림 수신 후 운영자 확인 (추가 조치 필요 시 수동 대응) |

---

### n8n 리뷰 AI 자동화 워크플로우 (n8n.도메인.com)

> **구현 기능:** Phase 1b: `F008`, `F009` | Phase 2 추가: `F024` | Phase 4 추가: `F041`, `F042` | **실행:** 매일 스케줄 트리거

| 항목 | 내용 |
|------|------|
| **역할** | 자사몰 리뷰 완전 자동화 + 스마트스토어 AI 답변 초안 보조 (리뷰 API 미지원 확정) + 리뷰 유도 자동화 |
| **진입 경로** | 매일 n8n 스케줄 트리거. 리뷰 유도는 배송완료 D+7 스케줄 |
| **사용자 행동** | 자사몰: 자동 실행 + 텔레그램 승인 플로우. 스마트스토어: AI 초안 수신 후 판매자센터에서 수동 등록 (영구 수동 방식 — 리뷰 API 미지원 확정) |
| **주요 기능** | - **자사몰 (완전 자동)**: 메이크샵 API 리뷰 수집 → OpenAI 감성 분석 → 별점 4~5 일반 칭찬은 메이크샵 API(댓글 등록)로 자동 답변 → 노션 리뷰 DB 기록<br>- **자사몰 확인 필요**: 개선요청/질문 포함 리뷰 → AI 초안 → 텔레그램 [이대로 등록] / [수정] 승인 플로우<br>- **자사몰 부정 리뷰**: 별점 1~3 → 텔레그램 긴급 알림 + AI 참고안<br>- **스마트스토어 (AI 보조 전용)**: 운영자가 리뷰 내용을 텔레그램으로 전달하면 AI 답변 초안 생성 → 판매자센터 수동 등록 (F042, 리뷰 API 미지원 확정으로 자동화 불가)<br>- **스마트스토어 부정 리뷰**: 운영자가 판매자센터에서 발견 후 텔레그램으로 공유 시 긴급 알림 처리 (F041)<br>- **리뷰 유도 (F024)**: 배송완료 D+7 리뷰 미작성 고객 → 알림톡 + 적립금 보상 안내<br>- **리뷰→콘텐츠 제안 (F031)**: 별점 5 + 사진 포함 리뷰 감지 → 텔레그램으로 SNS 활용 추천<br>- 노션 리뷰 DB 전건 기록 |
| **다음 이동** | 자사몰: 자동 처리 완료 또는 승인 후 API 등록. 스마트스토어: AI 초안 복사 → 판매자센터 수동 등록 |

---

### n8n 고객 경험 고도화 워크플로우 (n8n.도메인.com)

> **구현 기능:** `F020`, `F021`, `F022`, `F023`, `F025` | **실행:** 이벤트 기반 + 스케줄 트리거

| 항목 | 내용 |
|------|------|
| **역할** | 구매 데이터 기반 VIP 관리, 장바구니 이탈 유도, 휴면 재활성화, 주문 상태 알림, 혜택 자동 지급으로 매출과 재구매율 향상 |
| **진입 경로** | (1) 월 1회 스케줄 (VIP/휴면) (2) 매일 10:00 스케줄 (장바구니 이탈) (3) 주문 상태 변경 이벤트 (알림톡) |
| **사용자 행동** | 자동 실행. 운영자는 텔레그램 알림으로 처리 결과 확인 |
| **주요 기능** | - **VIP 자동 승급 (F020)**: 월 1회 메이크샵 회원 주문 통계 조회 → VIP 기준 충족(예: 3회 이상 구매 또는 누적 15만원 이상) → 회원 그룹 자동 변경 → 축하 알림톡 + 쿠폰/적립금 자동 지급 → 텔레그램 알림<br>- **장바구니 이탈 유도 (F021)**: 매일 10:00 장바구니 조회 → 24시간 이탈 고객 필터링 → 할인 쿠폰 포함 알림톡 자동 발송 (메이크샵 send_sms API)<br>- **휴면 재활성화 (F022)**: 휴면 전환 예정 D-7 조회 → 복귀 할인 쿠폰 + 개인화 알림톡 자동 발송 (메이크샵 send_sms API)<br>- **주문 상태 알림톡 (F023)**: 입금 확인/배송 시작/배송 완료 시 메이크샵 자체 알림톡 자동 발송 (관리자 설정, n8n 불필요) → 배송 관련 CS 자연 감소<br>- **혜택 자동 지급 (F025)**: 구매횟수/금액 기준 이벤트 조건 충족 시 쿠폰/적립금/포인트 자동 발급 |
| **다음 이동** | 텔레그램 알림 수신 후 운영자 확인 (추가 조치 필요 시 수동 대응) |

---

### n8n SNS 리마인더 워크플로우 (n8n.도메인.com)

> **구현 기능:** `F030`, `F031`, `F033`, `F034` | **실행:** 매일 21:00 + 매주 일요일 20:00 + 이벤트 기반

| 항목 | 내용 |
|------|------|
| **역할** | 노션 콘텐츠 캘린더 기반 SNS 발행 리마인드 + 리뷰 콘텐츠 추천 + SEO/프로모션 자동화 |
| **진입 경로** | 매일 21:00, 매주 일요일 20:00, 발행일 +3일, 좋은 리뷰 감지 이벤트 |
| **사용자 행동** | 자동 실행. 운영자는 텔레그램 알림 확인 후 노션 콘텐츠 캘린더에서 직접 제작/발행 |
| **주요 기능** | - **매일 21:00**: 내일 발행 예정 콘텐츠 목록 + 미완성 항목 경고 알림 (F030)<br>- **매주 일요일 20:00**: 다음 주 7일 콘텐츠 일정 현황 + 빠른 제작 가능 콘텐츠 유형 추천 (F030)<br>- **발행일 +3일**: 성과 체크 리마인더 (좋아요/저장/도달 노션 기록 요청) (F030)<br>- **리뷰→콘텐츠 제안**: 좋은 리뷰 감지 시 SNS 활용 텔레그램 자동 추천 (F031)<br>- **SEO 자동 등록**: 키워드 트렌드 반영 메이크샵 상품 SEO 자동 등록 (F033)<br>- **기획전 자동 관리**: 노션 프로모션 캘린더 기반 기획전 자동 생성/종료 (F034) |
| **다음 이동** | 알림 수신 후 운영자가 노션 콘텐츠 캘린더에서 제작/발행 처리 |

---

### n8n 경쟁사 모니터링 워크플로우 (n8n.도메인.com)

> **구현 기능:** `F050` | **실행:** 매일 09:00 스케줄 트리거 (Phase 5, 최후순위)

| 항목 | 내용 |
|------|------|
| **역할** | 네이버 쇼핑 경쟁 상품 가격과 순위를 매일 자동 수집하여 유의미한 변동 시 운영자에게 알림 |
| **진입 경로** | 매일 09:00 n8n 스케줄 트리거 |
| **사용자 행동** | 자동 실행. 운영자는 텔레그램 알림 확인 후 가격 전략 판단 |
| **주요 기능** | - 네이버 검색 API(쇼핑)로 키워드(웨딩기프트/결혼답례품 등) 상위 상품 가격/순위 수집<br>- 변동 감지 기준: 가격 ±5% 이상, 순위 ±3위 이상, 신규 상품 TOP10 진입<br>- 변동 시에만 텔레그램 알림 (변동 없으면 노션 기록만)<br>- 노션 가격 이력 DB 매일 기록<br>- 매주 월요일 09:00 주간 경쟁 분석 리포트 텔레그램 발송<br>- **제외**: 쿠팡 크롤링 (robots.txt 차단) → 수동 모니터링 |
| **다음 이동** | 알림 수신 후 운영자가 가격/이벤트 전략 독립 판단 (자동 가격 변경 없음) |

---

### 노션 CS 문의 DB

> **구현 기능:** `F004`, `F006` | **관리:** 자사몰 자동 기록 + 타 채널 수동 기록

| 항목 | 내용 |
|------|------|
| **역할** | 전 채널 CS 이력 통합 보관. 자사몰은 자동 기록, 타 채널은 운영자 수동 기록 |
| **진입 경로** | 자사몰: n8n 워크플로우가 자동 생성. 타 채널: 운영자가 직접 기록 |
| **사용자 행동** | 타 채널 CS 수신 시 노션에 수동 등록. 답변 완료 시 상태를 "답변완료"로 변경 |
| **주요 기능** | - 자동 기록 필드 (자사몰): 채널/카테고리/긴급도/고객명/접수일시/내용<br>- 수동 기록 필드 (타 채널): 위 필드를 운영자가 직접 입력<br>- 수동 업데이트 필드: 상태(미답변→답변완료→종결)/답변일시/답변내용/사용 템플릿<br>- 수식 필드: 응답시간 자동 계산 (답변일시 - 접수일시)<br>- 미답변 필터 뷰: n8n 미답변 추적 쿼리 대상 |
| **다음 이동** | 상태 업데이트 → n8n 미답변 추적 쿼리에서 제외 |

---

### 노션 CS 템플릿 DB

> **구현 기능:** `F005`, `F007` | **관리:** 초기 18개 수동 입력, 이후 추가

| 항목 | 내용 |
|------|------|
| **역할** | 자주 사용하는 CS 답변 템플릿 관리. n8n 키워드 매칭 엔진의 데이터 소스 |
| **진입 경로** | 초기 구축 시 수동 입력 후, 신규 반복 패턴 발견 시 운영자가 직접 추가 |
| **사용자 행동** | 템플릿 작성 (템플릿명/카테고리/트리거 키워드/답변 내용/변수 등록), 텔레그램 추천 확인 후 복사 사용 |
| **주요 기능** | - 카테고리별 템플릿 관리 (상품문의 6개, 주문결제 5개, 배송 3개, 교환반품 4개, 초기 합계 18개)<br>- 트리거 키워드 설정 (n8n Code 노드에서 매칭 판단에 사용)<br>- 변수 치환 지원 ({상품명}, {송장번호} 등)<br>- 사용 횟수 자동 카운트 (n8n이 매칭 시 업데이트) |
| **다음 이동** | 매칭 시 텔레그램 알림에 답변 내용 미리보기 포함 |

---

### 노션 리뷰 DB

> **구현 기능:** `F008`, `F009`, `F024`, `F031`, `F041`, `F042`, `F043` | **관리:** 자사몰 자동 기록, 스마트스토어 AI 처리 시 자동 기록

| 항목 | 내용 |
|------|------|
| **역할** | 리뷰 전건 수집 기록. AI 답변 이력 추적, 감성 분석, 키워드 트렌드 분석 데이터 소스 |
| **진입 경로** | 자사몰: n8n 워크플로우가 매일 자동 생성. 스마트스토어: AI 초안 처리 시 자동 기록 |
| **사용자 행동** | 자사몰: 조회 전용. 스마트스토어: AI 초안으로 수동 답변 후 결과 기록 |
| **주요 기능** | - 자동 기록 필드: 상품명/채널/별점/리뷰 내용/등록일/AI 감성/키워드/답변방식/답변내용/답변일시<br>- 채널별 필터 뷰 (자사몰/스마트스토어)<br>- 미답변 필터 뷰 (답변 누락 건 확인용)<br>- Phase 4에서 감성 분석/키워드 트렌드 분석 (F043) 데이터 소스로 활용 |
| **다음 이동** | 주간 리뷰 분석 리포트 데이터 소스로 n8n이 조회 |

---

### 노션 콘텐츠 캘린더 DB

> **구현 기능:** `F030`, `F031`, `F034` | **관리:** 운영자 직접 관리 (n8n은 조회만)

| 항목 | 내용 |
|------|------|
| **역할** | SNS 포스팅 전 과정(아이디어→기획→제작→발행→성과) 관리 + 프로모션 캘린더 |
| **진입 경로** | 운영자가 직접 접근하여 콘텐츠 등록/상태 업데이트. n8n 알림에서 노션 링크로 바로 이동 |
| **사용자 행동** | 콘텐츠 기획 등록, 발행일/채널/상태 업데이트, 발행 후 성과 수치(좋아요/저장/도달) 기록 |
| **주요 기능** | - 상태 관리: 아이디어 → 기획 → 제작중 → 완성 → 예약완료 → 발행완료<br>- 채널 다중 선택 (인스타피드/인스타릴스/인스타스토리/블로그/스마트스토어소식)<br>- 타입 분류 (제품사진/리뷰리그램/이벤트/정보성/릴스/스토리)<br>- 프로모션 필드 추가: 기획전명/기간/할인율 (F034 기획전 자동화 연동)<br>- 성과 필드 (좋아요/댓글/저장/도달, 발행 후 수동 기록) |
| **다음 이동** | 발행 완료 후 +3일 n8n이 성과 체크 리마인더 발송 |

---

### 노션 경쟁사 상품 DB + 가격 이력 DB

> **구현 기능:** `F050` | **관리:** 경쟁사 DB는 운영자 초기 설정, 가격 이력은 n8n 자동 기록 (Phase 5)

| 항목 | 내용 |
|------|------|
| **역할** | 경쟁사 상품 DB: 모니터링 대상 관리. 가격 이력 DB: 일별 가격/순위 추이 데이터 축적 |
| **진입 경로** | 경쟁사 DB: 운영자가 초기 수동 등록. 가격 이력 DB: n8n이 매일 자동 생성 |
| **사용자 행동** | 경쟁사 DB: 모니터링 대상 상품 키워드 등록. 가격 이력 DB: 주로 조회 전용 |
| **주요 기능** | - 경쟁사 상품 DB: 상품명/업체명/채널/현재가/이전가/URL/모니터링 키워드 관리<br>- 가격 이력 DB: 날짜/키워드/내 가격/내 순위/최저가/최저가 업체/평균가 일별 기록<br>- **모니터링 범위**: 네이버 쇼핑만 (네이버 검색 API). 쿠팡은 수동 모니터링 |
| **다음 이동** | 주간 경쟁 분석 리포트 데이터 소스로 n8n이 조회 |

---

## 데이터 모델

### CS 문의 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID (노션 자동 생성) |
| 제목 | 문의 첫 줄 요약 | title |
| 채널 | 자사몰(1:1게시판)/톡톡/카카오/인스타/채널톡 | select |
| 입력방식 | 자동(API수집) / 수동(운영자) | select |
| 상태 | 미답변 / 답변완료 / 종결 | status |
| 카테고리 | 상품문의/배송/주문결제/교환반품/기타 | select |
| 긴급도 | 일반 / 긴급 / VIP | select |
| 고객명 | 채널톡 또는 API에서 추출 | text |
| 주문번호 | API 조회 결과 | text |
| 접수일시 | API 수집 시각 또는 수동 입력 | date |
| 답변일시 | 운영자 기록 | date |
| 응답시간 | 답변일시 - 접수일시 | formula |
| 내용 | 문의 전문 | text |
| 답변내용 | 운영자가 한 답변 기록 | text |
| 사용 템플릿 | CS 템플릿 DB 연결 | → CS 템플릿 DB |

### CS 템플릿 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| 템플릿명 | #구성품, #배송확인 등 해시태그 형식 | title |
| 카테고리 | 상품문의/배송/주문결제/교환반품 | select |
| 트리거 키워드 | n8n 매칭에 사용하는 키워드 목록 | text |
| 답변 내용 | 실제 답변 텍스트 ({변수} 포함) | text |
| 사용 횟수 | n8n이 매칭 시 자동 카운트 | number |
| 최종 수정일 | 마지막 업데이트 날짜 | date |

### 리뷰 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| 상품명 | 리뷰 대상 상품 | title |
| 채널 | 스마트스토어 / 자사몰 | select |
| 별점 | 1~5 | number |
| 리뷰 내용 | 고객 원문 | text |
| AI 감성 | 긍정 / 중립 / 부정 | select |
| 키워드 | 포장/배송/품질/가격/선물 등 | multi_select |
| 답변 방식 | API자동 / AI초안+수동등록 / 직접작성 | select |
| 답변 내용 | 실제 등록된 답변 텍스트 | text |
| 답변일시 | 답변 등록 시각 | date |
| 등록일 | 리뷰 작성일 | date |
| SNS활용여부 | 콘텐츠 추천 여부 | checkbox |

### 콘텐츠 캘린더 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| 제목 | 콘텐츠 또는 프로모션 제목 | title |
| 채널 | 인스타피드/릴스/스토리/블로그/스스소식 | multi_select |
| 상태 | 아이디어→기획→제작중→완성→예약완료→발행완료 | status |
| 발행일 | 발행 예정일 | date |
| 타입 | 제품사진/리뷰리그램/이벤트/정보성/릴스/프로모션 | select |
| 기획전명 | 프로모션 기획전 이름 (F034 연동) | text |
| 성과 | 좋아요/댓글/저장/도달 (발행 후 기록) | text |

### 경쟁사 상품 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| 상품명 | 경쟁 상품명 | title |
| 업체명 | 경쟁사 이름 | text |
| 채널 | 네이버쇼핑 | select |
| 현재가 | 최신 수집 가격 | number |
| 이전가 | 전일 가격 | number |
| URL | 상품 링크 | url |
| 모니터링 키워드 | 검색에 사용하는 키워드 | text |

### 가격 이력 DB (노션)
| 필드 | 설명 | 타입/관계 |
|------|------|----------|
| id | 고유 식별자 | UUID |
| 날짜 | 기록 날짜 | date |
| 키워드 | 검색 키워드 | select |
| 내 가격 | 내 상품 당일 가격 | number |
| 내 순위 | 검색 결과 내 순위 | number |
| 최저가 | 경쟁사 최저가 | number |
| 최저가 업체 | 최저가 업체명 | text |
| 평균가 | 상위 10개 평균가 | number |

---

## 기술 스택

### 자동화 엔진

- **n8n** (self-hosted Docker, latest) - 워크플로우 자동화 핵심 엔진
- **[Phase 3+ 선택] Typebot** (self-hosted Docker, latest) - 자사몰 AI 챗봇 빌더 + 런타임 위젯. Phase 1~2에서는 미설치

### 외부 API 및 서비스

| API | 용도 | 비용 | 상태 |
|-----|------|------|------|
| **Telegram Bot API** | 운영자 알림 수발신 | 무료 | 확인됨 |
| **Notion API** | 5개 DB CRUD (초당 3회 제한) | 무료 | 확인됨 |
| **채널톡 JS SDK** | 자사몰 라이브챗 (기존 유지) | 무료 | 확인됨 |
| **OpenAI API** (GPT-4o mini) | 리뷰 AI 감성 분석 + 답변 생성 + 챗봇 자유 질문 | 월 ~3,000~5,000원 | 확인됨 |
| **메이크샵 오픈 API** | 자사몰 리뷰/주문/회원/혜택/게시판/SEO/기획전 (시간당 500회) | 무료 | API 키 확보 완료 |
| **메이크샵 자체 알림톡** | 주문/배송/결제/리뷰유도 카카오 알림톡 자동 발송 (건당 15.6원, SMS 0.7건 차감) | 건당 15.6원 | 메이크샵 관리자 설정 + send_sms API |
| **네이버 검색 API** (쇼핑) | 경쟁사 가격/순위 수집 (Phase 5) | 무료 (일 25,000건) | API 키 발급 필요 |
| **택배사 추적 API** (스마트택배 등) | 배송 상태 조회 | 무료 티어 | 확인 필요 |
| **네이버 커머스 API** | 스마트스토어 상품 문의 + 고객 문의 조회/답변 (리뷰 API 미지원 확정) | 무료 | **API 키 확보 완료** (n8n 환경변수로 관리) |

> **제거된 API**: 사방넷 API (유료, 미사용), 쿠팡 Wing API (사방넷 중복 불가), 채널톡 Webhook (무료 플랜 미지원), SOLAPI (메이크샵 자체 알림톡이 더 저렴하여 불필요)
> **알림톡 전환**: 메이크샵 자체 카카오 알림톡 기능 사용 (건당 15.6원, SMS 충전 크레딧 0.7건 차감). 카카오톡 미설치 고객은 자동으로 SMS 발송 (1건 차감). 별도 외부 서비스 불필요.

---

### 핵심 메이크샵 API 목록

| 기능 | Method | type / process | Phase |
|------|--------|---------------|-------|
| 코멘트 평점형 후기 조회 | GET | review | Phase 1 |
| 게시글 댓글 등록 | POST | comment / store | Phase 1 |
| 1:1 게시판 조회 | GET | crm_board | Phase 1 |
| 1:1 게시글 답변 등록 | POST | crm_board / reply | Phase 1 |
| 주문 2.0 조회 | GET | order | Phase 1 |
| 주문 2.0 검색 지원 | GET | order_search | Phase 1 |
| 상품 조회 | GET | product | Phase 1 |
| 택배사 조회 | GET | delivery_company | Phase 1 |
| 입금 확인 처리 | POST | order / paid | Phase 1 (미수금) |
| 주문 취소 (입금전) | POST | order / cancel_done | Phase 1 (미수금) |
| SMS/알림톡 보내기 | POST | send_sms | Phase 1~2 (메이크샵 자체 알림톡 우선 발송, 카카오톡 미설치 시 SMS 자동 대체) |
| 회원 주문 통계 조회 | GET | user_order | Phase 2 (VIP) |
| 회원 그룹 변경 | POST | user_group_change / update | Phase 2 (VIP) |
| 장바구니 조회 | GET | cart | Phase 2 (이탈 유도) — 회원 > 기타. userid/기간 조회, limit 최대 5000. **API 확인 완료** |
| 휴면 회원 조회 | GET | user_dormant | Phase 2 (휴면) |
| 쿠폰 지급 | POST | coupon / give | Phase 2 (혜택) |
| 적립금 지급 | POST | reserve / give | Phase 2 (혜택) |
| 포인트 지급 | POST | point / give | Phase 2 (혜택) |
| 상품 SEO 등록 | POST | product_seo | Phase 3 |
| 기획전 등록/수정 | POST | plan / create, update | Phase 3 |

---

### 핵심 네이버 커머스 API 목록

> **API 키 상태**: 확보 완료 (App ID / Secret / 허용 IP는 n8n 환경변수로 관리 — PRD에 평문 기록 금지)
> - Token URL: `https://api.commerce.naver.com/external/v1/oauth2/token`
>
> **리뷰 API 미지원 확정**: 전체 8개 카테고리(인증/통계/문의/상품/정산/주문/커머스솔루션/판매자정보) 공식 문서 확인 완료. 리뷰 관련 API 없음.

| 카테고리 | 기능 | Method | 엔드포인트 | Phase |
|---------|------|--------|-----------|-------|
| **문의** | 상품 문의 목록 조회 | GET | /external/v1/product-questions | Phase 4 |
| **문의** | 상품 문의 답변 등록/수정 | PUT | /external/v1/product-questions/{questionId}/answers | Phase 4 |
| **문의** | 상품 문의 답변 템플릿 목록 조회 | GET | /external/v1/product-questions/answer-templates | Phase 4 |
| **문의** | 고객 문의 조회 | GET | /external/v1/customer-inquiries | Phase 4 |
| **문의** | 고객 문의 답변 등록 | POST | /external/v1/customer-inquiries/{inquiryId}/answers | Phase 4 |
| **문의** | 고객 문의 답변 수정 | PUT | /external/v1/customer-inquiries/{inquiryId}/answers | Phase 4 |
| **주문** | 상품 주문 목록 조회 | GET | /external/v1/pay-order/seller/product-orders | 참고용 |
| **주문** | 상품 주문 상세 내역 조회 | GET | /external/v1/pay-order/seller/product-orders/query | 참고용 |
| **주문** | 변경 상품 주문 내역 조회 | GET | /external/v1/pay-order/seller/product-orders/last-changed-statuses | 참고용 |
| **주문** | 발주 확인 처리 | POST | /external/v1/pay-order/seller/product-orders/confirm | 참고용 |
| **주문** | 발송 처리 | POST | /external/v1/pay-order/seller/product-orders/dispatch | 참고용 |
| **통계** | 판매 통계 조회 | GET | /external/v1/analytics/... | 참고용 |
| **판매자정보** | 판매자 정보 조회 | GET | /external/v1/seller/... | 참고용 |

> **우선 구현 대상**: 문의 카테고리 6개 엔드포인트 (Phase 4 F040 구현에 직접 활용)
> **참고용**: 주문/통계는 사방넷으로 관리 중이므로 필요 시에만 활용

---

### 네이버 커머스 API 인증 흐름

> 네이버 커머스 API는 일반 OAuth 2.0과 달리 **bcrypt 전자서명**이 필수다.
> 처음 보면 복잡해 보이지만, n8n Code 노드에서 순서대로 처리하면 된다.

#### 인증 흐름 단계별 설명

```
[Step 1] 전자서명(Client Secret Sign) 생성
   - password = "{client_id}_{timestamp(밀리초)}"   ← 언더스코어로 연결
   - salt     = client_secret                       ← API 시크릿 그대로 사용
   - 결과     = BCrypt.hashpw(password, salt)       ← bcrypt로 해싱
   - 최종     = Base64.encode(결과)                 ← Base64로 인코딩

[Step 2] 액세스 토큰 발급 (POST 요청)
   URL: https://api.commerce.naver.com/external/v1/oauth2/token
   Body (application/x-www-form-urlencoded):
     grant_type=client_credentials
     client_id={환경변수에서 로드}
     timestamp={현재 타임스탬프 밀리초}
     client_secret_sign={Step 1에서 생성한 서명}
     type=SELF

[Step 3] API 호출
   Header: Authorization: Bearer {발급받은 액세스 토큰}

[Step 4] 토큰 만료 처리 (401 응답 시)
   응답 코드: 401 + 오류코드 GW.AUTHN
   처리: 토큰 재발급 후 재시도 (fallback 로직 필수)
```

#### n8n 구현 방법 (Code 노드)

> **n8n v2.0 필수 설정**: Code 노드에서 환경변수 접근과 외부 모듈 사용이 기본 차단됨.
> Docker 환경변수에 다음을 반드시 추가해야 아래 코드가 동작한다:
> ```
> N8N_BLOCK_ENV_ACCESS_IN_NODE=false    # $env 접근 허용
> NODE_FUNCTION_ALLOW_EXTERNAL=bcryptjs  # 외부 모듈 require 허용
> ```
> 또한 커스텀 Dockerfile에 `RUN npm install -g bcryptjs` 추가 필요.
> (대안: `n8n-nodes-bcryptjs` 커뮤니티 노드 설치 시 Dockerfile 커스텀 불필요)

```javascript
// n8n Code 노드에서 bcrypt 전자서명 생성
// API 키는 n8n Credentials 또는 환경변수로 관리 (코드에 하드코딩 금지)
const clientId = $env.NAVER_COMMERCE_CLIENT_ID;
const clientSecret = $env.NAVER_COMMERCE_CLIENT_SECRET;
const timestamp = Date.now();

// password = clientId + "_" + timestamp
const password = `\${clientId}_\${timestamp}`;

// bcrypt 해시 생성 (salt = clientSecret)
const bcrypt = require('bcryptjs'); // bcryptjs 권장 (순수 JS, ARM64 호환)
const hashed = bcrypt.hashSync(password, clientSecret);

// Base64 인코딩
const clientSecretSign = Buffer.from(hashed).toString('base64');

// HTTP Request 노드로 토큰 발급 요청
return [{ clientId, timestamp, clientSecretSign }];
```

> **주의**: n8n v2.0부터 `N8N_BLOCK_ENV_ACCESS_IN_NODE` 기본값이 `true`로 변경됨.
> 위 코드가 동작하려면 Docker 환경변수 설정이 **반드시** 선행되어야 한다.
> 대안으로 n8n Credentials를 사용하여 `$credentials`로 접근하는 방식도 가능하다 (보안적으로 더 안전).

---

### 네이버 커머스 API 호출 제한 대응

> 메이크샵 API(시간당 500회)와는 다른 Token Bucket 방식이다.

#### 제한 유형

| 제한 유형 | 응답 코드 | 오류 코드 | 설명 |
|----------|---------|---------|------|
| Rate Limit | 429 | GW.RATE_LIMIT | 초당 최대 동시 요청 수 초과 |
| Quota Limit | 429 | GW.QUOTA_LIMIT | 시간당 판매자 리소스 요청 수 초과 |
| 인증 만료 | 401 | GW.AUTHN | 액세스 토큰 만료 |

#### 응답 헤더 활용

```
GNCP-GW-RateLimit-Replenish-Rate   ← 초당 보충되는 요청 수 (기본 한도)
GNCP-GW-RateLimit-Burst-Capacity   ← 버스트 모드 최대 한도 (기본의 2배)
GNCP-GW-RateLimit-Remaining        ← 현재 남은 요청 가능 수
```

#### n8n 대응 전략

```
1. 요청 전 Remaining 헤더 확인 → 0에 가까우면 1초 대기 후 재시도
2. 429 수신 시 → 1초 대기 후 최대 3회 재시도 (n8n Wait 노드 활용)
3. 버스트 모드: 한 번에 몰아서 보낼 경우 기본 한도 2배까지 허용됨
   (다음 1초에는 요청 수가 줄어드는 방식이므로 균등 분산이 안전)
4. 401 수신 시 → 토큰 재발급 → 원래 요청 재시도 (fallback 필수)
```

#### 네이버 커머스 API 호출 예산 계획

> Phase 4 구현 시 필요한 예상 호출 횟수 계획

| 시간대 | 작업 | 예상 호출 |
|--------|------|----------|
| 매일 09:00 | 스마트스토어 상품 문의 수집 | ~10회 |
| 매일 09:00 | 스마트스토어 고객 문의 수집 | ~10회 |
| 매일 09:00 | AI 답변 생성 후 답변 등록 | ~15회 |
| 매주 월요일 | 답변 템플릿 목록 조회 (캐싱 목적) | ~2회 |
| 토큰 발급 (1일 1회) | 액세스 토큰 발급 | ~1회 |
| **일일 예상** | | **~35~40회 (여유 충분)** |

---

### 쇼핑몰 프론트엔드 (메이크샵 공통 HTML)

- **Vanilla JS** - 메이크샵 D4 공통 HTML에 삽입 (빌드 도구 없음, CDN 로드)
- **채널톡 JS SDK** (CDN) - 자사몰 라이브챗 위젯 (기존 유지)
- **[Phase 3+ 선택] Typebot JS SDK** (CDN) - 자사몰 챗봇 위젯 (도입 시 채널톡 버튼 숨김 + 전환 트리거 연동)

### 도메인 구성

| 서브도메인 | 서비스 | 용도 |
|-----------|--------|------|
| `n8n.도메인.com` | n8n | 워크플로우 관리 (운영자 전용) |
| `chat.도메인.com` | [Phase 3+] Typebot Builder | 챗봇 시나리오 관리 (선택 도입 시) |
| `bot.도메인.com` | [Phase 3+] Typebot Viewer | 고객용 챗봇 위젯 런타임 (선택 도입 시) |

---

## 서버 인프라 대안 (2026-02-19 재조사 완료)

> **최소 요구사항**: n8n + PostgreSQL + Nginx Docker 동시 운영 → **최소 RAM 2~3GB 필수** (Typebot 미사용 시). Typebot 추가 시 +1.5GB
> 1GB RAM 서비스(GCP e2-micro, Azure B1s, Naver Micro)는 n8n 단독도 빠듯하여 **실전 대안에서 제외**

### 1순위: Oracle Cloud Free Tier ARM (현재 방향)

| 항목 | 사양 |
|------|------|
| Shape | VM.Standard.A1.Flex |
| 스펙 | 4 OCPU / 24GB RAM / 200GB (최대, 분할 가능) |
| OS | Ubuntu 22.04 aarch64 |
| 비용 | **영구 무료** |
| 리전 | 서울, 춘천, 도쿄, 오사카 등 |
| 문제점 | "Out of Host Capacity" 오류로 인스턴스 생성 극도로 어려움 |

**Oracle Cloud 인스턴스 획득 전략**:
1. **자동화 스크립트**: [oci-arm-host-capacity](https://github.com/hitrov/oci-arm-host-capacity) (PHP) 또는 [oracle-freetier-instance-creation](https://github.com/mohankumarpaluru/oracle-freetier-instance-creation) (Python) → 60초 간격 자동 시도 → 평균 24~72시간 내 성공 보고 다수
   > **ToS 주의**: Oracle Cloud ToS에서 과도한 자동화 API 호출을 제한할 수 있음. 60초 간격을 유지하고, 연속 72시간 초과 시도 시 수동 전환 또는 Contabo 대안 검토 권장. 계정 정지 사례는 보고된 바 없으나, 리스크 인지 필요.
2. **PAYG 업그레이드**: Pay As You Go로 전환하면 인스턴스 확보 유리 (무료 한도 내 과금 없음)
3. **리전 선택**: 서울보다 **춘천/오사카** 등 덜 인기 있는 리전에서 시도
4. **시간대**: 해당 리전 새벽 2~6시 + 주말에 시도
5. **인스턴스 분할**: 4 OCPU/24GB 한 번에 대신 **2 OCPU/12GB x 2개**로 나눠 시도 (작은 인스턴스가 확보 쉬움)

### 2순위: Contabo Cloud VPS 10 (도쿄 리전) — 즉시 사용 가능 최적 대안

| 항목 | 내용 |
|------|------|
| 스펙 | **3 vCPU / 8GB RAM / 75GB NVMe** |
| 비용 | **$4.95/월 (~6,500원)**, 연간 계약 시 ~$3.96 |
| 리전 | **일본 도쿄** (한국 레이턴시 30~50ms) |
| 트래픽 | 무제한 (32TB 공정사용) |
| Docker | 지원 (x86, n8n/Typebot Docker 이미지 호환) |
| 고정 IP | 포함 |
| DDoS 보호 | 기본 포함 |
| 평가 | **가성비 최강. $5 미만에 8GB RAM + 아시아 리전. Oracle 실패 시 즉시 전환 가능** |

### 3순위: Hetzner Cloud CAX11 ARM (유럽 리전)

| 항목 | 내용 |
|------|------|
| 스펙 | **2 vCPU (Ampere) / 4GB RAM / 40GB NVMe** |
| 비용 | **€3.79/월 (~5,500원)** |
| 리전 | 유럽만 (Nuremberg, Helsinki, Falkenstein) — 한국 레이턴시 150~250ms |
| Docker | 지원 (ARM64 네이티브) |
| 트래픽 | 20TB/월 |
| 평가 | 최저가 ARM VPS. 레이턴시가 있지만 자동화 백엔드용으로는 문제없음. 시간당 과금 가능 |

### 4순위: AWS Lightsail (서울 리전)

| 항목 | 내용 |
|------|------|
| 스펙 | 1 vCPU / 2GB RAM / 60GB SSD (2GB 플랜) |
| 비용 | **$10/월 (~13,000원)**, 3개월 무료 체험 가능 |
| 리전 | **서울 (ap-northeast-2)** — 최저 레이턴시 |
| Docker | 지원 |
| 평가 | 서울 리전 최저 레이턴시. 2GB RAM이 빠듯하지만 swap 확장으로 운영 가능 |

### 5순위: Vultr Cloud Compute (서울 리전)

| 항목 | 내용 |
|------|------|
| 스펙 | 1 vCPU / 2GB RAM / 50GB NVMe (2GB 플랜) |
| 비용 | **$12/월 (~15,600원)** |
| 리전 | **서울** (도쿄, 싱가포르도 가능) |
| Docker | 지원 |
| 평가 | 서울 리전 + 안정적 인프라. Lightsail보다 비싸지만 NVMe 스토리지 |

### 인프라 선택 전략 (비용별 시나리오)

```
[1단계] Oracle Cloud 자동화 스크립트로 인스턴스 확보 시도 (1~3일)
   ├── 성공 → Oracle Cloud 사용 (무료, 최고 스펙)
   └── 실패 ↓

[2단계] Contabo Cloud VPS 10 도쿄 리전 즉시 개설 ($4.95/월)
   → 8GB RAM으로 n8n + PostgreSQL + Nginx 여유롭게 운영 (Phase 3+ Typebot 추가해도 충분)
   → Oracle Cloud 확보되면 마이그레이션 후 Contabo 해지 가능
```

| 시나리오 | 서비스 | 월 비용 | RAM | 리전 |
|---------|--------|--------|-----|------|
| 무료 (0원) | Oracle Cloud Free Tier | 0원 | 24GB | 서울 |
| 초저가 (5,500원) | Hetzner CAX11 | €3.79 | 4GB | 유럽 |
| 저가 (6,500원) | **Contabo VPS (추천)** | $4.95 | **8GB** | **도쿄** |
| 안정성 우선 (13,000원) | AWS Lightsail | $10 | 2GB | 서울 |

### 인프라 스택 (Oracle / Contabo 기준)

- **PostgreSQL 15** (Docker) - n8n DB (Typebot 추가 시 공유)
- **Nginx** - 리버스 프록시 (서브도메인별 라우팅)
- **Certbot + Let's Encrypt** - HTTPS SSL 자동 갱신

#### n8n Docker 필수 환경변수 (v2.0+)

```yaml
# docker-compose.yml n8n 서비스에 추가
environment:
  - N8N_BLOCK_ENV_ACCESS_IN_NODE=false        # Code 노드에서 $env 접근 허용
  - NODE_FUNCTION_ALLOW_EXTERNAL=bcryptjs      # Code 노드에서 외부 모듈 허용
  - NAVER_COMMERCE_CLIENT_ID=${NAVER_CLIENT_ID}
  - NAVER_COMMERCE_CLIENT_SECRET=${NAVER_CLIENT_SECRET}
```

#### Docker 메모리 분배 계획 (8GB 서버 기준)

| 서비스 | 메모리 제한 (`mem_limit`) | 비고 |
|--------|--------------------------|------|
| n8n | 2GB | 워크플로우 실행 + OpenAI 호출 |
| PostgreSQL | 1GB | n8n DB |
| Nginx | 128MB | 리버스 프록시 |
| OS + 여유 | ~1GB | 시스템 + 버퍼 |
| **Phase 1~2 합계** | **~4.1GB** | **4GB RAM + swap 4GB 필수** (swap 없이 4GB RAM만으로는 부족) |
| [Phase 3+] Typebot Builder | 1GB | 선택 도입 시 추가 |
| [Phase 3+] Typebot Viewer | 512MB | 선택 도입 시 추가 |
| **전체 합계 (Phase 3+ 포함)** | **~5.6GB** | 8GB RAM 서버 권장, swap 4GB 추가 권장 |

---

## 메이크샵 API 호출 예산 계획 (시간당 500회 제한)

| 시간대 | 작업 | 예상 호출 |
|--------|------|----------|
| 매 1시간 | 미답변 CS 추적 + 무통장 주문 감시 | ~15회 |
| 매일 09:00 | 리뷰 수집 (Phase 1) | ~30회 |
| 매일 10:00 | 장바구니 이탈 조회 (Phase 2) | ~30회 |
| 매일 스케줄 | 휴면 회원 조회 (Phase 2) | ~20회 |
| 매일 21:00 | 리포트 조회 | ~20회 |
| 매주 월요일 | 스마트스토어 문의 일괄 처리 (Phase 4) | ~50회 |
| 매월 1일 | VIP 통계 조회 + 혜택 지급 + 휴면 대량 처리 | ~200회 |
| **일일 예상** | | **~300~400회 (500회 한도 내)** |

---

## 비용 요약

| 항목 | 서비스 | 월 비용 |
|------|--------|--------|
| 서버 | Oracle Cloud Free Tier ARM (0원) 또는 Contabo VPS 도쿄 ($4.95/월) | 0원 ~ 6,500원 |
| 자동화 | n8n (self-hosted Docker) | 0원 |
| 챗봇 | Phase 1~2 미사용 / Phase 3+ 카카오 오픈빌더(무료) 또는 Typebot(self-hosted) | 0원 |
| DB | PostgreSQL (Docker) | 0원 |
| 도메인 | 기존 보유 | 0원 |
| SSL | Let's Encrypt | 0원 |
| 텔레그램 | Bot API | 0원 |
| 노션 | API (무료 플랜) | 0원 |
| 메이크샵 API | 오픈 API | 0원 |
| 네이버 커머스 API | 스마트스토어 문의 연동 | 0원 |
| 네이버 검색 API | 경쟁사 모니터링 (Phase 5) | 0원 |
| **OpenAI API** | GPT-4o mini (리뷰 AI + CS 템플릿 추천) | 월 ~3,000~5,000원 |
| **메이크샵 알림톡** | 주문/배송/결제/리뷰유도 알림톡 (건당 15.6원, SMS 0.7건 차감) | Phase 1: ~1,400원, Phase 2: ~9,400~37,400원 |
| **월 합계** | (서버 비용 별도: Oracle 0원 / Contabo ~6,500원) | **Phase 1: ~4,400~6,400원 / Phase 2 이후: ~12,400~42,400원** |

> **메이크샵 자체 알림톡 비용 상세**:
> - **단가**: 알림톡 15.6원/건 (SMS 충전 크레딧 0.7건 차감), SMS 22원/건 (1건 차감)
> - **발송 방식**: 카카오톡 설치 고객 → 알림톡 우선 발송 (15.6원) / 미설치 고객 → SMS 자동 대체 (22원)
> - Phase 1 (미수금 알림만): 일 ~3건 x 15.6원 x 30일 = **~1,400원/월**
> - Phase 2 (장바구니 이탈 + 휴면 + 리뷰 유도): 일 ~20~80건 x 15.6원 x 30일 = **~9,400~37,400원/월**
> - **주문 상태 알림 (F023)**: 메이크샵 관리자 설정에서 자동 발송 → n8n 워크플로우 불필요, 추가 개발 없음
> - **기존 SMS(건당 22원) 대비 약 29% 절감** (알림톡 발송 비율 ~95% 기준)
> - **SOLAPI 대비 장점**: 별도 외부 서비스 가입/API 연동 불필요, 메이크샵 관리자에서 일괄 관리
>
> **메이크샵 알림톡 설정 요건**:
> - 카카오톡 채널 ID 보유 (**확보 완료, 별도 개설/심사 불필요**)
> - 메이크샵 관리자 > 회원관리 > 카카오 알림톡 > 알림톡 설정에서 "사용" 체크
> - 알림톡 템플릿 등록 + 카카오 검수 (영업일 3~5일, 유일한 대기 시간)
> - SMS 충전 크레딧 사전 구매 (알림톡 발송 시 0.7건, SMS 발송 시 1건 차감)
> - n8n 커스텀 알림: 메이크샵 send_sms API로 발송 (알림톡 설정 활성화 시 자동으로 알림톡 우선)
>
> AI 없이 키워드 매칭 + 템플릿 응답만으로도 운영 가능 (OpenAI 0원).
> Oracle Cloud 발급 실패 장기화 시 Contabo VPS($4.95/월) 즉시 전환.

---

## 구현 로드맵

### Phase 1a — CS 자동화 MVP (서버 배포 후 Week 1~3)

> Phase 1을 1a/1b로 분리: 입문자 기준 15개 작업을 3주에 완료하기 빠듯하므로 핵심 CS부터 안정화 후 리뷰로 확장

- [ ] 메이크샵 관리자 > 카카오 알림톡 설정 활성화 (기존 카카오 채널 연동 — 채널 이미 보유)
- [ ] 알림톡 템플릿 등록 + 카카오 검수 대기 (영업일 3~5일, 아래 작업과 병렬 진행)
- [ ] SMS 충전 크레딧 구매 (알림톡 0.7건/SMS 1건 차감 방식)
- [ ] 메이크샵 FAQ 게시판 강화 (상품/배송/주문/교환 FAQ 정리, 상세페이지 하단에 링크)
- [ ] n8n 워크플로우: 메이크샵 1:1 게시판 API 스케줄 조회 (매 30분) → 텔레그램 알림 + 노션 CS DB 기록
- [ ] 노션 CS 문의 DB + CS 템플릿 DB 생성 + 초기 18개 템플릿 입력
- [ ] n8n 워크플로우: CS 키워드 매칭 → 템플릿 추천
- [ ] n8n 워크플로우: 미답변 추적 (매 1시간)

### Phase 1b — 리뷰 + 미수금 자동화 (Week 4~5)

- [ ] n8n 워크플로우: 무통장 주문 감시 + 72시간 미입금 자동 취소
- [ ] n8n 워크플로우: 입금 확인 처리 + 출고 안내 알림톡 (메이크샵 send_sms API)
- [ ] 노션 리뷰 DB 생성
- [ ] n8n 워크플로우: 자사몰 리뷰 수집 + AI 감성 분석 + 자동 답변 등록
- [ ] n8n 워크플로우: 부정 리뷰 / 확인 필요 리뷰 텔레그램 긴급 알림
- [ ] n8n 워크플로우: CS + 리뷰 일일 리포트 (매일 21:00)

### Phase 2 — 고객 경험 고도화 (Week 6~8)

- [ ] n8n 워크플로우: VIP 자동 판별 + 그룹 승급 + 쿠폰/적립금 지급
- [ ] n8n 워크플로우: 장바구니 이탈 유도 (24시간 이탈 → 알림톡 + 쿠폰)
- [ ] n8n 워크플로우: 휴면 고객 재활성화 (D-7 → 복귀 쿠폰 + 알림톡)
- [ ] 메이크샵 관리자에서 주문 상태 알림톡 자동 발송 설정 (입금/배송/완료 — n8n 불필요)
- [ ] n8n 워크플로우: 리뷰 작성 유도 (배송완료 D+7 → 알림톡 + 적립금)
- [ ] n8n 워크플로우: 이벤트 조건 혜택 자동 지급 시스템

### Phase 3 — 마케팅 자동화 + 챗봇 선택 도입 (Week 9~11)

- [ ] [선택] 카카오 i 오픈빌더 챗봇 구축: 지식+(FAQ) 엑셀 업로드 → 카카오톡 채널 연결 (서버 부담 0, 권장)
- [ ] [선택] 또는 Typebot Docker 배포 + 자사몰 웹 위젯 삽입 (서버 1.5GB 추가, 자사몰 위젯 필요 시)
- [ ] 노션 콘텐츠 캘린더 DB 생성
- [ ] n8n 워크플로우: SNS 포스팅 리마인더 (매일 21:00 + 일요일 20:00)
- [ ] n8n 워크플로우: 리뷰→SNS 콘텐츠 자동 추천
- [ ] n8n 워크플로우: 반복 CS → 상세페이지 개선 인사이트 (월 1회)
- [ ] n8n 워크플로우: 상품 SEO 자동 등록
- [ ] n8n 워크플로우: 기획전 자동 생성/종료

### Phase 4 — 스마트스토어 확산 (Week 12~14)

- [x] 네이버 커머스 API 키 발급 완료 (n8n 환경변수로 관리)
- [ ] n8n Code 노드: bcrypt 전자서명 생성 + 토큰 발급 테스트
- [ ] n8n 워크플로우: 스마트스토어 상품 문의 AI 자동 답변 (PUT /product-questions/{id}/answers)
- [ ] n8n 워크플로우: 스마트스토어 고객 문의 AI 자동 답변 (POST /customer-inquiries/{id}/answers)
- [ ] n8n 워크플로우: 스마트스토어 답변 템플릿 캐싱 (GET /product-questions/answer-templates)
- [ ] n8n 워크플로우: 스마트스토어 부정 리뷰 AI 초안 보조 (수동 트리거 — 리뷰 API 미지원 확정)
- [ ] n8n 워크플로우: 리뷰 DB 감성 분석 + 키워드 트렌드 리포트

### Phase 5 — 경쟁사 모니터링 (여유 있을 때)

- [ ] 노션 경쟁사 상품 DB + 가격 이력 DB 생성
- [ ] 네이버 검색 API(쇼핑) 키 발급 + 테스트
- [ ] n8n 워크플로우: 네이버 쇼핑 가격/순위 모니터링 (매일 09:00)
- [ ] n8n 워크플로우: 주간 경쟁 분석 리포트 (매주 월요일)

---

## 개발 전 체크리스트

### 서버/인프라

- [ ] Oracle Cloud 서버 배포 완료 (자동화 스크립트로 1~3일 시도, 실패 시 **Contabo VPS 도쿄 $4.95/월** 즉시 전환)
- [ ] swap 파일 4GB 설정 (`fallocate -l 4G /swapfile && mkswap /swapfile && swapon /swapfile` + fstab 등록)
- [ ] Docker Compose 메모리 제한 설정 (n8n 2GB, PostgreSQL 1GB, Nginx 128MB)
- [ ] Nginx + HTTPS (Let's Encrypt) 설정 완료
- [ ] 노션 신규 DB 5개 생성 (CS문의/CS템플릿/리뷰/콘텐츠캘린더 — 경쟁사 DB는 Phase 5에서)

### Phase 1 API 키 발급 및 테스트

- [ ] 메이크샵 오픈 API 테스트 (리뷰 조회, 댓글 등록, 주문 조회, 1:1 문의 조회/답변, 입금 확인, 주문 취소)
- [ ] 메이크샵 관리자 > 카카오 알림톡 설정 활성화 확인 (기존 카카오 채널 연동 — 채널 이미 보유)
- [ ] 알림톡 템플릿 등록 + 카카오 검수 (미수금 알림/출고 안내/배송 안내/리뷰 유도 등 최소 5개, 검수 3~5영업일)
- [ ] 메이크샵 알림톡 발송 테스트 (관리자 설정 자동 발송 + n8n → send_sms API → 알림톡 수신 확인)
- [ ] SMS 충전 크레딧 구매 (Phase 1 예상: 월 ~90건 x 0.7건 = ~63 크레딧)
- [ ] 택배사 추적 API 키 발급 + 배송 추적 테스트 (스마트택배 sweettracker.co.kr 또는 Delivery Tracker)
- [ ] OpenAI API 키 발급 + GPT-4o mini 리뷰 답변 테스트
- [ ] 텔레그램 봇 @Pressco21_bot 연동 테스트
- [ ] 노션 API Integration Token 발급 + DB 연동 테스트

### Phase 4 API 테스트 (키 발급 완료)

- [x] 네이버 커머스 API 키 발급 완료 (n8n 환경변수로 관리, 허용 IP 설정됨)
- [ ] n8n에서 bcrypt 전자서명 생성 테스트 (bcrypt 또는 bcryptjs 모듈)
- [ ] 네이버 커머스 API 토큰 발급 테스트 (POST to Token URL)
- [ ] 네이버 커머스 API 상품 문의 조회 테스트 (GET /product-questions)
- [ ] 네이버 커머스 API 상품 문의 답변 등록 테스트 (PUT /product-questions/{id}/answers)
- [ ] 네이버 커머스 API 고객 문의 조회/답변 테스트
- [ ] ~~네이버 커머스 API 리뷰 조회 가능 여부 확인~~ → **미지원 확정 (공식 문서 확인 완료)**

### Phase 5 API 키 발급

- [ ] 네이버 검색 API(쇼핑) 키 발급 + 테스트 (developers.naver.com)

### [Phase 3+ 선택] 챗봇 도입 시 체크리스트

- [ ] **카카오 오픈빌더 (추천)**: i.kakao.com 가입 → 기존 카카오 채널 연결 → 지식+(FAQ) 엑셀 업로드 → 스킬서버(n8n Webhook) 연동
- [ ] **Typebot (자사몰 위젯 필요 시)**: Docker 배포 + 메이크샵 공통 HTML에 위젯 삽입 (`hideChannelButtonOnBoot: true`) + 채널톡 전환 JS 연동
- [ ] 메이크샵 D4 템플릿 리터럴 이스케이프 처리 확인 (`\${variable}` 형태)

---

## 보안 주의사항

| 항목 | 관리 방법 | 비고 |
|------|----------|------|
| 네이버 커머스 API App ID / Secret | n8n 환경변수 (`NAVER_COMMERCE_CLIENT_ID`, `NAVER_COMMERCE_CLIENT_SECRET`) | PRD/코드에 평문 기록 금지 |
| 메이크샵 오픈 API 키 | n8n Credentials | 어드민에서 허용 IP 설정 완료 |
| OpenAI API 키 | n8n Credentials | 월 사용량 한도 설정 권장 |
| 텔레그램 봇 토큰 | n8n Credentials | 봇 토큰 노출 시 즉시 재발급 |
| 노션 API Integration Token | n8n Credentials | DB별 접근 권한 최소화 |
| 택배사 추적 API 키 | n8n Credentials | 발급 후 환경변수 저장 |

> **Git 이력 주의**: API 키가 커밋된 적 있다면 `git filter-branch` 또는 `BFG Repo-Cleaner`로 이력에서도 제거하고, 키를 재발급해야 한다.

---

## 기술 검증 결과 요약 (prd-validator)

> 검증일: 2026-02-19 (1차), 2026-02-20 (2차 + 사용자 피드백 반영), 2026-02-20 (3차 + 사실 관계 검증)

### 종합 평가: **상** (실현 가능, 구조 간소화 완료)

### 반영 완료 항목
1. **API 키/시크릿 PRD에서 제거** — 환경변수 관리로 전환 완료
2. **메이크샵 자체 알림톡 전환** — SOLAPI 제거, 메이크샵 카카오 알림톡(15.6원/건) 사용 확정. 외부 서비스 불필요
3. **Phase 1 일정 현실화** — Phase 1a(CS, Week 1~3) + Phase 1b(리뷰/미수금, Week 4~5) 분리
4. **n8n v2.0 호환성 대응** — `N8N_BLOCK_ENV_ACCESS_IN_NODE=false`, `NODE_FUNCTION_ALLOW_EXTERNAL=bcryptjs` Docker 설정 추가
5. **Docker 메모리 분배 계획** — Phase 1~2: n8n+PostgreSQL+Nginx만 (~4.1GB, 4GB RAM + swap 4GB 필수)
6. **카카오 채널 보유 확인** — 이미 보유, 별도 개설/심사 불필요. 알림톡 템플릿 검수(3~5영업일)만 대기
7. **챗봇 전략 재수립** — Phase 1~2 챗봇 미사용 (과투자 방지), Phase 3+ 카카오 오픈빌더 선택 도입 (서버 부담 0)
8. **Typebot → 선택사항 전환** — 서버 리소스 1.5GB 절약, Docker 관리 부담 제거. 필요 시에만 도입
9. **서버 인프라 대안 강화** — Contabo/Hetzner/Lightsail/Vultr 비용별 시나리오 추가
10. **Oracle Cloud 자동화 스크립트 ToS 경고** — 72시간 초과 시 수동 전환 또는 대안 검토 권장
11. **오픈빌더 5초 타임아웃 대응** — 즉시 응답 + 비동기 후속 전달 전략 명시 (Phase 3+ 도입 시)
12. **SMS 단가 정정** — 공식 문서 기준 SMS 22원/건 (알림톡 15.6원 대비 29% 절감)
13. **카카오 오픈빌더 무료 전환 시점 정정** — 2022년 9월 1일부터 (공식 공지 확인)
14. **장바구니 API 확인 완료** — GET type=cart (회원 > 기타), userid/기간 조회, limit 5000. F021 구현 가능 확정
15. **구조도 Phase 배치 정합성 수정** — F041/F042를 Phase 4로, F024를 Phase 2로 이동

### 주요 리스크 Top 6

| 순위 | 리스크 | 심각도 | 발생확률 | 대응 방안 |
|------|--------|-------|---------|----------|
| 1 | Oracle Cloud "Out of Host Capacity" 장기화 | 높음 | 중 | 자동화 스크립트(oci-arm-host-capacity)로 24~72시간 시도 → 실패 시 **Contabo VPS 도쿄($4.95/월, 8GB RAM)** 즉시 전환 |
| 2 | ~~SMS 비용 Phase 2 이후 급증~~ → **해결됨** | ~~중~~ | ~~높음~~ | **메이크샵 자체 알림톡(건당 15.6원)으로 전환 확정. SMS(22원) 대비 29% 절감. 외부 서비스 불필요** |
| 3 | n8n bcrypt 모듈 ARM64 호환성 | 중 | 중 | bcryptjs(순수 JS) 대안 준비, 서버 배포 후 즉시 테스트 |
| 4 | 채널톡 무료 플랜 타 채널 CS 자동화 불가 | 중 | 확정 | 자사몰만 자동화, 타 채널은 수동 노션 기록 (현행 유지) |
| 5 | ~~메이크샵 장바구니(cart) API 미확인~~ → **확인 완료** | ~~중~~ | ~~중~~ | **API 존재 확인 (회원 > 기타 > 장바구니 조회, GET type=cart). userid/기간 조회 지원, limit 최대 5000. F021 구현 가능** |
| 6 | 네이버 커머스 API Rate Limit 미공개 | 낮음 | 중 | 일일 ~35회로 여유 충분, 429 응답 시 retry/backoff 구현 |

### 추가 권장사항
- 단일 서버 장애 대비 n8n 워크플로우 JSON 자동 백업 (주 1회 → 노션 or 구글 드라이브)
- Notion API 초당 3회 제한 → 6개 DB 동시 운영 시 요청 큐잉/분산 필요
- OpenAI 월 비용 상한 설정 권장 (예기치 않은 대량 호출 방지)
